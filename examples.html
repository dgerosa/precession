<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Examples &mdash; precession 2.0.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Package documentation" href="auto.html" />
    <link rel="prev" title="Readme" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            precession
          </a>
              <div class="version">
                2.0.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Readme</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#select-a-binary-configuration">1. Select a binary configuration.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#inspiral">2. Inspiral</a></li>
<li class="toctree-l2"><a class="reference internal" href="#precession-average-what-you-like">3. Precession average what you like</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="auto.html">Package documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">precession</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Examples</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="examples">
<h1>Examples<a class="headerlink" href="#examples" title="Permalink to this heading"></a></h1>
<p>This is a <a class="reference external" href="https://github.com/dgerosa/precession/blob/master/utils/examples.ipynb">short
notebook</a>
to illustrate some of the key features of the <code class="docutils literal notranslate"><span class="pre">precession</span></code> module.
There much more than this in the code but hopefully this is a good
starting point.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">importlib.machinery</span> <span class="kn">import</span> <span class="n">SourceFileLoader</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">precession</span> <span class="o">=</span> <span class="n">SourceFileLoader</span><span class="p">(</span><span class="s2">&quot;precession&quot;</span><span class="p">,</span> <span class="s2">&quot;../precession/precession.py&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">load_module</span><span class="p">()</span>
</pre></div>
</div>
<p>(The import syntax above is to make sure the online documentation grabs
the latest version. For you it should just be <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">precession</span></code> )</p>
<section id="select-a-binary-configuration">
<h2>1. Select a binary configuration.<a class="headerlink" href="#select-a-binary-configuration" title="Permalink to this heading"></a></h2>
<p>First, set the constants of motion. These include mass ratio and spin
magnitudes:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span>
<span class="go">0.8</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chi1</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chi1</span>
<span class="go">0.5</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chi2</span> <span class="o">=</span> <span class="mf">0.9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chi2</span>
<span class="go">0.9</span>
</pre></div>
</div>
<p>From these, find a suitable value of the effective spin within its
geometrical limits</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chieff_minus</span><span class="p">,</span><span class="n">chieff_plus</span><span class="o">=</span><span class="n">precession</span><span class="o">.</span><span class="n">chiefflimits</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">chi1</span><span class="o">=</span><span class="n">chi1</span><span class="p">,</span> <span class="n">chi2</span><span class="o">=</span><span class="n">chi2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chieff</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">chieff</span><span class="o">&gt;=</span><span class="n">chieff_minus</span> <span class="ow">and</span> <span class="n">chieff</span><span class="o">&lt;=</span><span class="n">chieff_plus</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chieff</span>
<span class="go">0.1</span>
</pre></div>
</div>
<p>Now the quantities that vary on the radiation-reaction timescale.
Specify the orbital separation</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span>
<span class="go">1000</span>
</pre></div>
</div>
<p>Find a suitable value of the asymptotic angular momentum (its boundaries
are the spin-orbit resonances):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">kappa_minus</span><span class="p">,</span><span class="n">kappa_plus</span><span class="o">=</span><span class="n">precession</span><span class="o">.</span><span class="n">kappalimits</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">,</span><span class="n">chieff</span><span class="o">=</span><span class="n">chieff</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">chi1</span><span class="o">=</span><span class="n">chi1</span><span class="p">,</span> <span class="n">chi2</span><span class="o">=</span><span class="n">chi2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kappa</span> <span class="o">=</span> <span class="mf">0.02</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">kappa</span><span class="o">&gt;=</span><span class="n">kappa_minus</span> <span class="ow">and</span> <span class="n">kappa</span><span class="o">&lt;=</span><span class="n">kappa_plus</span>
</pre></div>
</div>
<p>This is more conventiently done by specifying a dimensionless number,
e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">kappa</span> <span class="o">=</span> <span class="n">precession</span><span class="o">.</span><span class="n">kapparescaling</span><span class="p">(</span><span class="n">kappatilde</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">,</span> <span class="n">chieff</span><span class="o">=</span><span class="n">chieff</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">chi1</span><span class="o">=</span><span class="n">chi1</span><span class="p">,</span> <span class="n">chi2</span><span class="o">=</span><span class="n">chi2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kappa</span>
<span class="go">array([0.04563644])</span>
</pre></div>
</div>
<p>Finally, the precession-timescale variation is encoded in the weighted
spin difference. Its limits are given by the solutions of a cubic
polynomial:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">deltachi_minus</span><span class="p">,</span><span class="n">deltachi_plus</span> <span class="o">=</span> <span class="n">precession</span><span class="o">.</span><span class="n">deltachilimits</span><span class="p">(</span><span class="n">kappa</span><span class="o">=</span><span class="n">kappa</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">,</span><span class="n">chieff</span><span class="o">=</span><span class="n">chieff</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="n">chi1</span><span class="o">=</span><span class="n">chi1</span><span class="p">,</span><span class="n">chi2</span><span class="o">=</span><span class="n">chi2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">deltachi</span><span class="o">=-</span><span class="mf">0.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">deltachi</span><span class="o">&gt;=</span><span class="n">deltachi_minus</span> <span class="ow">and</span> <span class="n">deltachi</span><span class="o">&lt;=</span><span class="n">deltachi_plus</span>
</pre></div>
</div>
<p>You can also sample deltachi from its PN-weighted porability density
function</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">deltachi</span> <span class="o">=</span> <span class="n">precession</span><span class="o">.</span><span class="n">deltachisampling</span><span class="p">(</span><span class="n">kappa</span><span class="o">=</span><span class="n">kappa</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">,</span> <span class="n">chieff</span><span class="o">=</span><span class="n">chieff</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">chi1</span><span class="o">=</span><span class="n">chi1</span><span class="p">,</span> <span class="n">chi2</span><span class="o">=</span><span class="n">chi1</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Or, as before, specify a dimensionless number, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">deltachi</span> <span class="o">=</span> <span class="n">precession</span><span class="o">.</span><span class="n">deltachirescaling</span><span class="p">(</span><span class="n">deltachitilde</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">kappa</span><span class="o">=</span><span class="n">kappa</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">,</span> <span class="n">chieff</span><span class="o">=</span><span class="n">chieff</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">chi1</span><span class="o">=</span><span class="n">chi1</span><span class="p">,</span> <span class="n">chi2</span><span class="o">=</span><span class="n">chi2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">deltachi</span>
<span class="go">array([-0.15027382])</span>
</pre></div>
</div>
<p>From these quantities, one can compute the spin angles</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">theta1</span><span class="p">,</span> <span class="n">theta2</span><span class="p">,</span> <span class="n">deltaphi</span> <span class="o">=</span> <span class="n">precession</span><span class="o">.</span><span class="n">conserved_to_angles</span><span class="p">(</span><span class="n">deltachi</span><span class="o">=</span><span class="n">deltachi</span><span class="p">,</span> <span class="n">kappa</span><span class="o">=</span><span class="n">kappa</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">,</span> <span class="n">chieff</span><span class="o">=</span><span class="n">chieff</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">chi1</span><span class="o">=</span><span class="n">chi1</span><span class="p">,</span> <span class="n">chi2</span><span class="o">=</span><span class="n">chi2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta1</span><span class="p">,</span><span class="n">theta2</span><span class="p">,</span><span class="n">deltaphi</span>
<span class="go">(array([1.66141316]), array([1.25261228]), array([1.4089439]))</span>
</pre></div>
</div>
<p>The inverse operation is</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">deltachi_</span><span class="p">,</span> <span class="n">kappa_</span><span class="p">,</span> <span class="n">chieff_</span> <span class="o">=</span> <span class="n">precession</span><span class="o">.</span><span class="n">angles_to_conserved</span><span class="p">(</span><span class="n">theta1</span><span class="o">=</span><span class="n">theta1</span><span class="p">,</span> <span class="n">theta2</span><span class="o">=</span><span class="n">theta2</span><span class="p">,</span> <span class="n">deltaphi</span><span class="o">=</span><span class="n">deltaphi</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">chi1</span><span class="o">=</span><span class="n">chi1</span><span class="p">,</span> <span class="n">chi2</span><span class="o">=</span><span class="n">chi2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">deltachi_</span><span class="p">,</span><span class="n">deltachi</span><span class="p">)</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">kappa_</span><span class="p">,</span><span class="n">kappa</span><span class="p">)</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">chieff_</span><span class="p">,</span><span class="n">chieff</span><span class="p">)</span>
</pre></div>
</div>
<p>One can now compute various derived quantities including:</p>
<ul class="simple">
<li><p>The precession period</p></li>
<li><p>The total precession angle</p></li>
<li><p>Two flavors of the precession estimator chip</p></li>
<li><p>The spin morphology</p></li>
<li><p>… and many more!</p></li>
</ul>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tau</span> <span class="o">=</span> <span class="n">precession</span><span class="o">.</span><span class="n">eval_tau</span><span class="p">(</span><span class="n">kappa</span><span class="o">=</span><span class="n">kappa</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">,</span> <span class="n">chieff</span><span class="o">=</span><span class="n">chieff</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">chi1</span><span class="o">=</span><span class="n">chi1</span><span class="p">,</span> <span class="n">chi2</span><span class="o">=</span><span class="n">chi2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tau</span>
<span class="go">array([1.14179292e+09])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span> <span class="o">=</span> <span class="n">precession</span><span class="o">.</span><span class="n">eval_alpha</span><span class="p">(</span><span class="n">kappa</span><span class="o">=</span><span class="n">kappa</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">,</span> <span class="n">chieff</span><span class="o">=</span><span class="n">chieff</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">chi1</span><span class="o">=</span><span class="n">chi1</span><span class="p">,</span> <span class="n">chi2</span><span class="o">=</span><span class="n">chi2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span>
<span class="go">array([34.7076951])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chip_averaged</span> <span class="o">=</span> <span class="n">precession</span><span class="o">.</span><span class="n">eval_chip</span><span class="p">(</span><span class="n">deltachi</span><span class="o">=</span><span class="n">deltachi</span><span class="p">,</span><span class="n">kappa</span><span class="o">=</span><span class="n">kappa</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">,</span><span class="n">chieff</span><span class="o">=</span><span class="n">chieff</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="n">chi1</span><span class="o">=</span><span class="n">chi1</span><span class="p">,</span><span class="n">chi2</span><span class="o">=</span><span class="n">chi2</span><span class="p">,</span><span class="n">which</span><span class="o">=</span><span class="s2">&quot;averaged&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chip_averaged</span>
<span class="go">array([0.74912589])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chip_rms</span> <span class="o">=</span> <span class="n">precession</span><span class="o">.</span><span class="n">eval_chip</span><span class="p">(</span><span class="n">deltachi</span><span class="o">=</span><span class="n">deltachi</span><span class="p">,</span><span class="n">kappa</span><span class="o">=</span><span class="n">kappa</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">,</span><span class="n">chieff</span><span class="o">=</span><span class="n">chieff</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="n">chi1</span><span class="o">=</span><span class="n">chi1</span><span class="p">,</span><span class="n">chi2</span><span class="o">=</span><span class="n">chi2</span><span class="p">,</span><span class="n">which</span><span class="o">=</span><span class="s2">&quot;rms&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chip_rms</span>
<span class="go">array([0.81485269])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">morph</span> <span class="o">=</span> <span class="n">precession</span><span class="o">.</span><span class="n">morphology</span><span class="p">(</span><span class="n">kappa</span><span class="o">=</span><span class="n">kappa</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">,</span> <span class="n">chieff</span><span class="o">=</span><span class="n">chieff</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">chi1</span><span class="o">=</span><span class="n">chi1</span><span class="p">,</span> <span class="n">chi2</span><span class="o">=</span><span class="n">chi2</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">morph</span>
<span class="go">array([&#39;C+&#39;], dtype=&#39;&lt;U32&#39;)</span>
</pre></div>
</div>
</section>
<section id="inspiral">
<h2>2. Inspiral<a class="headerlink" href="#inspiral" title="Permalink to this heading"></a></h2>
<p>Let’s now evolve that binary configuration down to r=10M.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rvals</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span> <span class="c1"># Specify all the outputs you want here</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outputs</span> <span class="o">=</span> <span class="n">precession</span><span class="o">.</span><span class="n">inspiral_precav</span><span class="p">(</span><span class="n">kappa</span><span class="o">=</span><span class="n">kappa</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="n">rvals</span><span class="p">,</span><span class="n">chieff</span><span class="o">=</span><span class="n">chieff</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="n">chi1</span><span class="o">=</span><span class="n">chi1</span><span class="p">,</span><span class="n">chi2</span><span class="o">=</span><span class="n">chi2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outputs</span>
<span class="go">{&#39;theta1&#39;: array([[1.7312008 , 1.24398405]]),</span>
<span class="go"> &#39;theta2&#39;: array([[1.20154756, 1.54372751]]),</span>
<span class="go"> &#39;deltaphi&#39;: array([[0.53955355, 2.22995857]]),</span>
<span class="go"> &#39;deltachi&#39;: array([[-0.18873195,  0.07834759]]),</span>
<span class="go"> &#39;kappa&#39;: array([[0.04563644, 0.06977371]]),</span>
<span class="go"> &#39;r&#39;: array([[1000,   10]]),</span>
<span class="go"> &#39;u&#39;: array([[0.06403612, 0.64036123]]),</span>
<span class="go"> &#39;deltachiminus&#39;: array([[-0.19622919, -0.42562113]]),</span>
<span class="go"> &#39;deltachiplus&#39;: array([[-0.08134075,  0.26825594]]),</span>
<span class="go"> &#39;deltachi3&#39;: array([[0.74325701, 0.1801658 ]]),</span>
<span class="go"> &#39;chieff&#39;: array([0.1]),</span>
<span class="go"> &#39;q&#39;: array([0.8]),</span>
<span class="go"> &#39;chi1&#39;: array([0.5]),</span>
<span class="go"> &#39;chi2&#39;: array([0.9])}</span>
</pre></div>
</div>
<p>The same evolution can also be done with an orbit-averaged scheme (note
that now you have to specify deltachi as well). This is slow:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">outputs</span> <span class="o">=</span> <span class="n">precession</span><span class="o">.</span><span class="n">inspiral_orbav</span><span class="p">(</span><span class="n">deltachi</span><span class="o">=</span><span class="n">deltachi</span><span class="p">,</span> <span class="n">kappa</span><span class="o">=</span><span class="n">kappa</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="n">rvals</span><span class="p">,</span><span class="n">chieff</span><span class="o">=</span><span class="n">chieff</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="n">chi1</span><span class="o">=</span><span class="n">chi1</span><span class="p">,</span><span class="n">chi2</span><span class="o">=</span><span class="n">chi2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outputs</span>
<span class="go">{&#39;t&#39;: array([[0.000000e+00, 7.935974e+10]]),</span>
<span class="go"> &#39;theta1&#39;: array([[1.66141316, 0.88395959]]),</span>
<span class="go"> &#39;theta2&#39;: array([[1.25261228, 1.76230812]]),</span>
<span class="go"> &#39;deltaphi&#39;: array([[1.4089439 , 3.07301966]]),</span>
<span class="go"> &#39;Lh&#39;: array([[ 3.13179178e-02,  5.33207833e-18,  9.99509474e-01],</span>
<span class="go">        [ 1.24544160e-03, -6.64332657e-02,  9.97790094e-01]]),</span>
<span class="go"> &#39;S1h&#39;: array([[-0.73494006,  0.67476338, -0.06750919],</span>
<span class="go">        [ 0.15694222, -0.79776377,  0.58218746]]),</span>
<span class="go"> &#39;S2h&#39;: array([[-0.73753054, -0.5857321 ,  0.33610506],</span>
<span class="go">        [-0.13214016,  0.98330163, -0.12513138]]),</span>
<span class="go"> &#39;deltachi&#39;: array([[-0.15027382,  0.25227467]]),</span>
<span class="go"> &#39;kappa&#39;: array([[0.04563644, 0.06865318]]),</span>
<span class="go"> &#39;r&#39;: array([[1000,   10]]),</span>
<span class="go"> &#39;u&#39;: array([[0.06403612, 0.64036123]]),</span>
<span class="go"> &#39;chieff&#39;: array([[0.1       , 0.09999999]]),</span>
<span class="go"> &#39;q&#39;: array([0.8]),</span>
<span class="go"> &#39;chi1&#39;: array([0.5]),</span>
<span class="go"> &#39;chi2&#39;: array([0.9]),</span>
<span class="go"> &#39;cyclesign&#39;: array([[1., 1.]])}</span>
</pre></div>
</div>
<p>Let’s now take this binary at r=10M, and propagate it back to past time
infinity:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rvals</span> <span class="o">=</span> <span class="p">[</span><span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]</span> <span class="c1"># Specify all the outputs you want here</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outputs</span> <span class="o">=</span> <span class="n">precession</span><span class="o">.</span><span class="n">inspiral_precav</span><span class="p">(</span><span class="n">kappa</span><span class="o">=</span><span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;kappa&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">r</span><span class="o">=</span><span class="n">rvals</span><span class="p">,</span><span class="n">chieff</span><span class="o">=</span><span class="n">chieff</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="n">chi1</span><span class="o">=</span><span class="n">chi1</span><span class="p">,</span><span class="n">chi2</span><span class="o">=</span><span class="n">chi2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outputs</span>
<span class="go">{&#39;theta1&#39;: array([[0.98611104, 1.66496015]]),</span>
<span class="go"> &#39;theta2&#39;: array([[1.70448376, 1.25002889]]),</span>
<span class="go"> &#39;deltaphi&#39;: array([[-2.65961075,  1.38198175]]),</span>
<span class="go"> &#39;deltachi&#39;: array([[ 0.20663165, -0.15223596]]),</span>
<span class="go"> &#39;kappa&#39;: array([[0.06865318, 0.04154245]]),</span>
<span class="go"> &#39;r&#39;: array([[10., inf]]),</span>
<span class="go"> &#39;u&#39;: array([[0.64036123, 0.        ]]),</span>
<span class="go"> &#39;deltachiminus&#39;: array([[-0.43153997,         nan]]),</span>
<span class="go"> &#39;deltachiplus&#39;: array([[0.25313088,        nan]]),</span>
<span class="go"> &#39;deltachi3&#39;: array([[0.18034069,        nan]]),</span>
<span class="go"> &#39;chieff&#39;: array([0.1]),</span>
<span class="go"> &#39;q&#39;: array([0.8]),</span>
<span class="go"> &#39;chi1&#39;: array([0.5]),</span>
<span class="go"> &#39;chi2&#39;: array([0.9])}</span>
</pre></div>
</div>
</section>
<section id="precession-average-what-you-like">
<h2>3. Precession average what you like<a class="headerlink" href="#precession-average-what-you-like" title="Permalink to this heading"></a></h2>
<p>The code also allow you to precession-average quantities specified by
the users. For instance, let’s compute the average of deltachi.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">deltachi</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">deltachi</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">deltachiav_</span> <span class="o">=</span> <span class="n">precession</span><span class="o">.</span><span class="n">precession_average</span><span class="p">(</span><span class="n">kappa</span><span class="o">=</span><span class="n">kappa</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">,</span> <span class="n">chieff</span><span class="o">=</span><span class="n">chieff</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">chi1</span><span class="o">=</span><span class="n">chi1</span><span class="p">,</span> <span class="n">chi2</span><span class="o">=</span><span class="n">chi2</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">func</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">deltachiav_</span>
<span class="go">array([-0.13857097])</span>
</pre></div>
</div>
<p>For this specific case, the averaged can also be done semi-analytically
in terms of elliptic integrals (though in general this is not possible).
Let’s check we get the same result:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">precession</span><span class="o">.</span><span class="n">eval_u</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">deltachiminus</span><span class="p">,</span><span class="n">deltachiplus</span><span class="p">,</span><span class="n">deltachi3</span> <span class="o">=</span> <span class="n">precession</span><span class="o">.</span><span class="n">deltachiroots</span><span class="p">(</span><span class="n">kappa</span><span class="o">=</span><span class="n">kappa</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="n">u</span><span class="p">,</span> <span class="n">chieff</span><span class="o">=</span><span class="n">chieff</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">chi1</span><span class="o">=</span><span class="n">chi1</span><span class="p">,</span> <span class="n">chi2</span><span class="o">=</span><span class="n">chi2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">precession</span><span class="o">.</span><span class="n">elliptic_parameter</span><span class="p">(</span><span class="n">kappa</span><span class="o">=</span><span class="n">kappa</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="n">u</span><span class="p">,</span> <span class="n">chieff</span><span class="o">=</span><span class="n">chieff</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">chi1</span><span class="o">=</span><span class="n">chi1</span><span class="p">,</span> <span class="n">chi2</span><span class="o">=</span><span class="n">chi2</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">precomputedroots</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">deltachiminus</span><span class="p">,</span> <span class="n">deltachiplus</span><span class="p">,</span> <span class="n">deltachi3</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">deltachiav</span> <span class="o">=</span> <span class="n">precession</span><span class="o">.</span><span class="n">inverseaffine</span><span class="p">(</span> <span class="n">precession</span><span class="o">.</span><span class="n">deltachitildeav</span><span class="p">(</span><span class="n">m</span><span class="p">),</span>  <span class="n">deltachiminus</span><span class="p">,</span> <span class="n">deltachiplus</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">deltachiav</span>
<span class="go">array([-0.13857097])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">deltachiav_</span><span class="o">-</span><span class="n">deltachiav</span><span class="p">)</span><span class="o">/</span><span class="n">deltachiav</span>
<span class="go">array([-8.99340873e-14])</span>
</pre></div>
</div>
<p>This is also an example of how providing the optional quantity
<code class="docutils literal notranslate"><span class="pre">precomputedroots</span></code> speeds up the computation.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Readme" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="auto.html" class="btn btn-neutral float-right" title="Package documentation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Copyright (c) Davide Gerosa.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>