Notebook[{

Cell[CellGroupData[{
Cell["precession v2: polynomial coefficients", \
"Title",ExpressionUUID->"b17277b1-6a23-4651-9cf2-c29cf465a2b1"],

Cell["Davide Gerosa", \
"Subtitle",ExpressionUUID->"fa2e1eb5-cc4d-4c5c-9f6a-00bfcc0e9fb9"],

Cell[TextData[StyleBox["This is a notebook to derive some long polynomial \
coefficients that describe the dynamics of spinning black-hole binaries at \
2PN. In particular, we present \[LineSeparator]expressions for (i) the \
effective potentials, (ii) the evolution of the total spin on the \
precessional timescale, (iii) the identification of the spin-orbit resonances \
in terms of the generalized angular momentum \[Kappa], and (iv)  the \
identification of the spin-orbit resonances in terms of the effective spin \
\[Xi].  ", "Subsection"]], \
"Subtitle",ExpressionUUID->"ea4b9c66-a8ae-4a61-bb29-819185e6ee0d"],

Cell[CellGroupData[{

Cell["\<\
Export expressions in a format that python and numpy are going to like. Use a \
modified version of the package by Gustavo Wiederhecker  \
https://github.com/gwiederhecker/ToPython, supplemented by a set of custom \
transformation for the precession code. \
\>", "Subsubsection",
 CellChangeTimes->{
  3.855916718056891*^9},ExpressionUUID->"e9b046e6-a73b-4267-9087-\
44473ef83e97"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ToPython", "[", 
    RowBox[{"x_", ",", 
     RowBox[{"numpyprefix_", ":", "\"\<np\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"expression", "=", "x"}], ",", "greekrule", ",", "PythonForm", 
       ",", 
       RowBox[{"numpypre", "=", "numpyprefix"}], ",", "lp", ",", "rp", ",", 
       "a", ",", "b"}], "}"}], ",", "\n", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"By", " ", "Gustavo", " ", "Wiederhecker"}], ",", " ", 
       RowBox[{"minor", " ", "edits", " ", "by", " ", "Davide", " ", 
        RowBox[{"Gerosa", "."}]}]}], "*)"}], "\n", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"numpyprefix", "==", "\"\<\>\""}], ",", 
        RowBox[{"sep", "=", "\"\<\>\""}], ",", 
        RowBox[{"sep", "=", "\"\<.\>\""}]}], "]"}], ";", "\n", 
      RowBox[{"lp", "=", "\"\<(\>\""}], ";", "\n", 
      RowBox[{"rp", "=", "\"\<)\>\""}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", 
        RowBox[{"Rational", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"PythonForm", "[", "a", "]"}], "<>", "\"\</\>\"", "<>", 
        RowBox[{"PythonForm", "[", "b", "]"}]}]}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", 
        RowBox[{"Complex", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<complex\>\"", "<>", "lp", "<>", 
        RowBox[{"PythonForm", "[", "a", "]"}], "<>", "\"\<,\>\"", "<>", 
        RowBox[{"PythonForm", "[", "b", "]"}], "<>", "rp"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", 
        RowBox[{"Times", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"PythonForm", "[", "a", "]"}], "<>", "\"\< * \>\"", "<>", 
        RowBox[{"PythonForm", "[", "b", "]"}]}]}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", 
        RowBox[{"Plus", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", 
       RowBox[{"lp", "<>", 
        RowBox[{"PythonForm", "[", "a", "]"}], "<>", "\"\< + \>\"", "<>", 
        RowBox[{"PythonForm", "[", "b", "]"}], "<>", "rp"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", 
        RowBox[{"h_", "[", "args__", "]"}], "]"}], ":=", 
       RowBox[{"numpypre", "<>", "sep", "<>", 
        RowBox[{"ToLowerCase", "[", 
         RowBox[{"PythonForm", "[", "h", "]"}], "]"}], "<>", "lp", "<>", 
        RowBox[{"PythonForm", "[", "args", "]"}], "<>", "rp"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", 
        RowBox[{"Power", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", 
       RowBox[{"lp", "<>", 
        RowBox[{"PythonForm", "[", "a", "]"}], "<>", "rp", "<>", "\"\<**\>\"",
         "<>", "lp", "<>", 
        RowBox[{"PythonForm", "[", "b", "]"}], "<>", "rp"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", "a_ListQ", "]"}], ":=", 
       RowBox[{"numpypre", "<>", "sep", "<>", "\"\<array\>\"", "<>", 
        RowBox[{"StringReplace", "[", 
         RowBox[{
          RowBox[{"ToString", "[", "a", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<{\>\"", "->", " ", "\"\<[\>\""}], ",", 
            RowBox[{"\"\<}\>\"", "->", " ", "\"\<]\>\""}]}], "}"}]}], 
         "]"}]}]}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", "Arg", "]"}], "=", 
       RowBox[{"numpypre", "<>", "sep", "<>", "\"\<angle\>\""}]}], ";", "\n", 
      
      RowBox[{
       RowBox[{"PythonForm", "[", "Csc", "]"}], ":=", 
       RowBox[{
       "\"\<1/\>\"", "<>", "numpypre", "<>", "sep", "<>", "\"\<sin\>\""}]}], 
      ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", "Sec", "]"}], ":=", 
       RowBox[{
       "\"\<1/\>\"", "<>", "numpypre", "<>", "sep", "<>", "\"\<cos\>\""}]}], 
      ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", "Cot", "]"}], ":=", 
       RowBox[{
       "\"\<1/\>\"", "<>", "numpypre", "<>", "sep", "<>", "\"\<tan\>\""}]}], 
      ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", "Csch", "]"}], ":=", 
       RowBox[{
       "\"\<1/\>\"", "<>", "numpypre", "<>", "sep", "<>", "\"\<sinh\>\""}]}], 
      ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", "Sech", "]"}], ":=", 
       RowBox[{
       "\"\<1/\>\"", "<>", "numpypre", "<>", "sep", "<>", "\"\<cosh\>\""}]}], 
      ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", "Coth", "]"}], ":=", 
       RowBox[{
       "\"\<1/\>\"", "<>", "numpypre", "<>", "sep", "<>", "\"\<tanh\>\""}]}], 
      ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", 
        RowBox[{"List", "[", "args__", "]"}], "]"}], ":=", 
       RowBox[{
       "numpypre", "<>", "sep", "<>", "\"\<array\>\"", "<>", "lp", "<>", 
        "\"\<[\>\"", "<>", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"PythonForm", "[", 
            RowBox[{
             RowBox[{"{", "args", "}"}], "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "]"}], "<>", "\"\<,\>\""}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", 
            RowBox[{"Length", "@", 
             RowBox[{"{", "args", "}"}]}]}], "}"}]}], "]"}], "<>", 
        "\"\<]\>\"", "<>", "rp"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", "\[Pi]", "]"}], "=", 
       RowBox[{"numpypre", "<>", "sep", "<>", "\"\<pi\>\""}]}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", "E", "]"}], "=", 
       RowBox[{"numpypre", "<>", "sep", "<>", "\"\<e\>\""}]}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", "r_Real", "]"}], ":=", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", "=", 
           RowBox[{"MantissaExponent", "[", "r", "]"}]}], "}"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"r", ">=", "0"}], ",", 
           RowBox[{
            RowBox[{"ToString", "[", 
             RowBox[{"N", "[", 
              RowBox[{
               RowBox[{"a", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "6"}], "]"}], "]"}], 
            "<>", "\"\<e\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"a", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"\"\<(\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"N", "[", 
              RowBox[{
               RowBox[{"a", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "6"}], "]"}], "]"}], 
            "<>", "\"\<e\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"a", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", "\"\<)\>\""}]}], 
          "]"}]}], "]"}]}], ";", "\n", 
      RowBox[{"greekrule", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<\[Alpha]\>\"", "->", "\"\<alpha\>\""}], ",", 
         RowBox[{"\"\<\[Beta]\>\"", "->", "\"\<beta\>\""}], ",", 
         RowBox[{"\"\<\[Gamma]\>\"", "->", "\"\<gamma\>\""}], ",", 
         RowBox[{"\"\<\[Delta]\>\"", "->", "\"\<delta\>\""}], ",", 
         RowBox[{"\"\<\[CurlyEpsilon]\>\"", "->", "\"\<curlyepsilon\>\""}], 
         ",", 
         RowBox[{"\"\<\[Zeta]\>\"", "->", "\"\<zeta\>\""}], ",", 
         RowBox[{"\"\<\[Eta]\>\"", "->", "\"\<eta\>\""}], ",", 
         RowBox[{"\"\<\[Theta]\>\"", "->", "\"\<theta\>\""}], ",", 
         RowBox[{"\"\<\[Iota]\>\"", "->", "\"\<iota\>\""}], ",", 
         RowBox[{"\"\<\[Kappa]\>\"", "->", "\"\<kappa\>\""}], ",", 
         RowBox[{"\"\<\[Lambda]\>\"", "->", "\"\<lambda\>\""}], ",", 
         RowBox[{"\"\<\[Mu]\>\"", "->", "\"\<mu\>\""}], ",", 
         RowBox[{"\"\<\[Nu]\>\"", "->", "\"\<nu\>\""}], ",", 
         RowBox[{"\"\<\[Xi]\>\"", "->", "\"\<xi\>\""}], ",", 
         RowBox[{"\"\<\[Omicron]\>\"", "->", "\"\<omicron\>\""}], ",", 
         RowBox[{"\"\<\[Pi]\>\"", "->", "\"\<pi\>\""}], ",", 
         RowBox[{"\"\<\[Rho]\>\"", "->", "\"\<rho\>\""}], ",", 
         RowBox[{"\"\<\[FinalSigma]\>\"", "->", "\"\<finalsigma\>\""}], ",", 
         RowBox[{"\"\<\[Sigma]\>\"", "->", "\"\<sigma\>\""}], ",", 
         RowBox[{"\"\<\[Tau]\>\"", "->", "\"\<tau\>\""}], ",", 
         RowBox[{"\"\<\[Upsilon]\>\"", "->", "\"\<upsilon\>\""}], ",", 
         RowBox[{"\"\<\[CurlyPhi]\>\"", "->", "\"\<curlyphi\>\""}], ",", 
         RowBox[{"\"\<\[Chi]\>\"", "->", "\"\<chi\>\""}], ",", 
         RowBox[{"\"\<\[Psi]\>\"", "->", "\"\<psi\>\""}], ",", 
         RowBox[{"\"\<\[Omega]\>\"", "->", "\"\<omega\>\""}], ",", 
         RowBox[{"\"\<\[CapitalAlpha]\>\"", "->", "\"\<Alpha\>\""}], ",", 
         RowBox[{"\"\<\[CapitalBeta]\>\"", "->", "\"\<Beta\>\""}], ",", 
         RowBox[{"\"\<\[CapitalGamma]\>\"", "->", "\"\<Gamma\>\""}], ",", 
         RowBox[{"\"\<\[CapitalDelta]\>\"", "->", "\"\<Delta\>\""}], ",", 
         RowBox[{"\"\<\[CapitalEpsilon]\>\"", "->", "\"\<CurlyEpsilon\>\""}], 
         ",", 
         RowBox[{"\"\<\[CapitalZeta]\>\"", "->", "\"\<Zeta\>\""}], ",", 
         RowBox[{"\"\<\[CapitalEta]\>\"", "->", "\"\<Eta\>\""}], ",", 
         RowBox[{"\"\<\[CapitalTheta]\>\"", "->", "\"\<Theta\>\""}], ",", 
         RowBox[{"\"\<\[CapitalIota]\>\"", "->", "\"\<Iota\>\""}], ",", 
         RowBox[{"\"\<\[CapitalKappa]\>\"", "->", "\"\<Kappa\>\""}], ",", 
         RowBox[{"\"\<\[CapitalLambda]\>\"", "->", "\"\<Lambda\>\""}], ",", 
         RowBox[{"\"\<\[CapitalMu]\>\"", "->", "\"\<Mu\>\""}], ",", 
         RowBox[{"\"\<\[CapitalNu]\>\"", "->", "\"\<Nu\>\""}], ",", 
         RowBox[{"\"\<\[CapitalXi]\>\"", "->", "\"\<Xi\>\""}], ",", 
         RowBox[{"\"\<\[CapitalOmicron]\>\"", "->", "\"\<Omicron\>\""}], ",", 
         
         RowBox[{"\"\<\[CapitalPi]\>\"", "->", "\"\<Pi\>\""}], ",", 
         RowBox[{"\"\<\[CapitalRho]\>\"", "->", "\"\<Rho\>\""}], ",", 
         RowBox[{"\"\<\[CapitalSigma]\>\"", "->", "\"\<Sigma\>\""}], ",", 
         RowBox[{"\"\<\[CapitalTau]\>\"", "->", "\"\<Tau\>\""}], ",", 
         RowBox[{"\"\<\[CapitalUpsilon]\>\"", "->", "\"\<Upsilon\>\""}], ",", 
         
         RowBox[{"\"\<\[CapitalPhi]\>\"", "->", "\"\<CurlyPhi\>\""}], ",", 
         RowBox[{"\"\<\[CapitalChi]\>\"", "->", "\"\<Chi\>\""}], ",", 
         RowBox[{"\"\<\[CapitalPsi]\>\"", "->", "\"\<Psi\>\""}], ",", 
         RowBox[{"\"\<\[CapitalOmega]\>\"", "->", "\"\<Omega\>\""}]}], 
        "}"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", "allOther_", "]"}], ":=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"allOther", ",", "FortranForm"}], "]"}], ",", "greekrule"}],
         "]"}]}], ";", "\n", 
      RowBox[{"PythonForm", "[", "expression", "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"e8b63d30-4618-4520-872e-9b912512205d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"precessionform", "[", 
    RowBox[{"label_", ",", "expression_"}], "]"}], ":=", 
   RowBox[{"\"\<# Machine generated with \>\"", "<>", 
    RowBox[{"Last", "@", 
     RowBox[{"FileNameSplit", "@", 
      RowBox[{"NotebookFileName", "[", "]"}]}]}], "<>", "\"\<\\n\>\"", "<>", 
    " ", "label", "<>", "\"\< = \>\"", "<>", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToPython", "[", "expression", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<(q)\>\"", "\[Rule]", "\"\<q\>\""}], ",", 
        RowBox[{"\"\<(L)\>\"", "\[Rule]", "\"\<L\>\""}], ",", 
        RowBox[{"\"\<(S)\>\"", "\[Rule]", "\"\<S\>\""}], ",", 
        RowBox[{"\"\<(J)\>\"", "\[Rule]", "\"\<J\>\""}], ",", 
        RowBox[{"\"\<(S1)\>\"", "\[Rule]", "\"\<S1\>\""}], ",", 
        RowBox[{"\"\<(S2)\>\"", "\[Rule]", "\"\<S2\>\""}], ",", 
        RowBox[{"\"\<(u)\>\"", "->", "\"\<u\>\""}], ",", 
        RowBox[{"\"\<(kappa)\>\"", "->", "\"\<kappa\>\""}], ",", 
        RowBox[{"\"\<(chieff)\>\"", "->", "\"\<chieff\>\""}], ",", 
        RowBox[{"\"\<(2)\>\"", "->", "\"\<2\>\""}], ",", 
        RowBox[{"\"\<(3)\>\"", "->", "\"\<3\>\""}], ",", 
        RowBox[{"\"\<(4)\>\"", "->", "\"\<4\>\""}], ",", 
        RowBox[{"\"\<(5)\>\"", "->", "\"\<5\>\""}], ",", 
        RowBox[{"\"\<(6)\>\"", "->", "\"\<6\>\""}], ",", 
        RowBox[{"\"\<(7)\>\"", "->", "\"\<7\>\""}], ",", 
        RowBox[{"\"\<(8)\>\"", "->", "\"\<8\>\""}], ",", 
        RowBox[{"\"\<(9)\>\"", "->", "\"\<9\>\""}], ",", 
        RowBox[{"\"\<(10)\>\"", "->", "\"\<10\>\""}]}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellLabel->"In[2]:=",ExpressionUUID->"7221c56f-5388-4b56-b37e-44404e96ae6a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["(ii) Effective potentials", \
"Section",ExpressionUUID->"9ea1069a-567c-496d-a00c-043641530aeb"],

Cell[CellGroupData[{

Cell["See Eqs. (13-14) of Gerosa et al. (2015), arxiv:1506.03492. ", \
"Subsubsection",ExpressionUUID->"cb0712bc-3f9d-472f-8ab4-fbab1f86da2d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t1", "=", 
   FractionBox["1", 
    RowBox[{"4", "q", "  ", 
     RowBox[{"S", "^", "2"}], " ", "L"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t2", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"J", "^", "2"}], " ", "-", " ", 
      RowBox[{"L", "^", "2"}], "-", 
      RowBox[{"S", "^", "2"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "^", "2"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "q"}], ")"}], "^", "2"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"S1", "^", "2"}], "-", 
         RowBox[{"S2", "^", "2"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"q", "^", "2"}]}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t3", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"q", "^", "2"}]}], ")"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"L", "+", "S"}], ")"}], "^", "2"}], "-", 
       RowBox[{"J", "^", "2"}]}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}]}], "  ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"J", "^", "2"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"L", "-", "S"}], ")"}], "^", "2"}]}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"S1", "+", "S2"}], ")"}], "^", "2"}], "-", 
       RowBox[{"S", "^", "2"}]}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}]}], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"S", "^", "2"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"S1", "-", "S2"}], ")"}], "^", "2"}]}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}]}]}]}], " ", ";"}]}], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"13f83d6d-0148-41f6-a6f1-a7ab2698307f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"chieffSvarphi", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"t1", 
     RowBox[{"(", 
      RowBox[{"t2", "-", 
       RowBox[{
        RowBox[{"Cos", "[", "varphi", "]"}], "t3"}]}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<chieff\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[6]:=",ExpressionUUID->"164930b9-ad35-43f1-9d3e-9553868af547"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\nchieff = 1/4 \
* L**(-1) * q**(-1) * S**(-2) * ((J**2 + (-1 * L**2 + -1 * S**2)) * (((1 + \
q))**2 * S**2 + (-1 + q**2) * (S1**2 + -1 * S2**2)) + -1 * (1 + -1 * q**2) * \
((J**2 + -1 * ((L + -1 * S))**2))**(1/2) * ((-1 * J**2 + ((L + \
S))**2))**(1/2) * ((S**2 + -1 * ((S1 + -1 * S2))**2))**(1/2) * ((-1 * S**2 + \
((S1 + S2))**2))**(1/2) * np.cos(varphi))\"\>"], "Output",
 CellLabel->"Out[7]=",ExpressionUUID->"aabe7b07-a641-4d1e-8452-d2df72124f12"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cosvarphi", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[Chi]eff"}], " ", "/", "t1"}], " ", "+", " ", "t2"}], 
      ")"}], "/", "t3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<cosvarphi\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[8]:=",ExpressionUUID->"3d0dbe10-1ec2-4509-a715-d109144c95e7"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncosvarphi = \
((1 + -1 * q**2))**(-1) * ((J**2 + -1 * ((L + -1 * S))**2))**(-1/2) * ((-1 * \
J**2 + ((L + S))**2))**(-1/2) * ((S**2 + -1 * ((S1 + -1 * S2))**2))**(-1/2) * \
((-1 * S**2 + ((S1 + S2))**2))**(-1/2) * ((J**2 + (-1 * L**2 + -1 * S**2)) * \
(((1 + q))**2 * S**2 + (-1 + q**2) * (S1**2 + -1 * S2**2)) + -4 * L * q * \
S**2 * chieff)\"\>"], "Output",
 CellLabel->"Out[9]=",ExpressionUUID->"aaf56f98-7fdb-4ba4-8ac8-85e112f28c09"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["(ii) Cubic equation in S^2 ", \
"Section",ExpressionUUID->"c428d816-58d8-4f72-94f0-631b1810e67d"],

Cell[CellGroupData[{

Cell["\<\
Equation (\[Chi]eff_\[PlusMinus](S)-\[Chi]eff)^2=0; substitute  \[Kappa] and \
u; multiply by some constant factors for consistency with previous \
derivations.\
\>", "Subsubsection",ExpressionUUID->"7f6271e4-a4a4-4685-80bc-79c743d75db5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"effpot", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"t3", "^", "2"}], " ", "-", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Chi]eff", "/", "t1"}], ")"}], " ", "-", " ", "t2"}], ")"}],
      "^", "2"}]}], " ", "]"}]}]], "Input",
 CellLabel->"In[10]:=",ExpressionUUID->"5a56251c-59df-4c96-83df-5acc7bc83e1e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["q", "2"]}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["J", "2"], "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"L", "-", "S"}], ")"}], "2"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["J", "2"]}], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"L", "+", "S"}], ")"}], "2"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["S", "2"], "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"S1", "-", "S2"}], ")"}], "2"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["S", "2"]}], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"S1", "+", "S2"}], ")"}], "2"]}], ")"}]}], "-", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["J", "2"], "-", 
        SuperscriptBox["L", "2"], "-", 
        SuperscriptBox["S", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "q"}], ")"}], "2"], " ", 
         SuperscriptBox["S", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["q", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["S1", "2"], "-", 
           SuperscriptBox["S2", "2"]}], ")"}]}]}], ")"}]}], "-", 
     RowBox[{"4", " ", "L", " ", "q", " ", 
      SuperscriptBox["S", "2"], " ", "\[Chi]eff"}]}], ")"}], "2"]}]], "Output",
 CellLabel->
  "Out[10]=",ExpressionUUID->"496860fa-4de8-4d0f-8e20-e6da83a92581"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"effpot", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"u", "^", "2"}], "  ", 
         RowBox[{"effpot", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "4"}], " ", 
            RowBox[{"S", "^", "2"}]}], ")"}]}]}], "//.", 
        RowBox[{"{", 
         RowBox[{"J", "\[Rule]", 
          RowBox[{"Sqrt", "[", "Js", "]"}]}], "}"}]}], "//.", 
       RowBox[{"{", 
        RowBox[{"Js", "->", 
         RowBox[{
          RowBox[{"2", " ", "L", " ", "\[Kappa]"}], " ", "+", " ", 
          RowBox[{"L", "^", "2"}]}]}], "}"}]}], "//.", 
      RowBox[{"{", 
       RowBox[{"L", "\[Rule]", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"2", "u"}], ")"}]}]}], "}"}]}], "//.", 
     RowBox[{"{", 
      RowBox[{"S", "->", 
       RowBox[{"Sqrt", "[", "Ss", "]"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellLabel->"In[11]:=",ExpressionUUID->"1c1271b4-9189-4541-9cd3-36880a4ac5e4"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["q", "2"]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["S1", "2"], "-", 
       RowBox[{"2", " ", "S1", " ", "S2"}], "+", 
       SuperscriptBox["S2", "2"], "-", "Ss"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["S1", "2"], "+", 
       RowBox[{"2", " ", "S1", " ", "S2"}], "+", 
       SuperscriptBox["S2", "2"], "-", "Ss"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SqrtBox["Ss"]}], "+", 
       RowBox[{"Ss", " ", "u"}], "-", "\[Kappa]"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SqrtBox["Ss"], "+", 
       RowBox[{"Ss", " ", "u"}], "-", "\[Kappa]"}], ")"}]}], "-", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["q", "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["S1", "2"], "-", 
             SuperscriptBox["S2", "2"]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "q"}], ")"}], "2"], " ", "Ss"}]}], ")"}], " ", 
        
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Ss", " ", "u"}], "-", "\[Kappa]"}], ")"}]}], "+", 
       RowBox[{"2", " ", "q", " ", "Ss", " ", "\[Chi]eff"}]}], ")"}], "2"]}], 
   
   RowBox[{"4", " ", "Ss"}]]}]], "Output",
 CellLabel->
  "Out[11]=",ExpressionUUID->"3f9d8798-0af0-40d3-9e1d-cd54377c03c8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extract coefficients.", \
"Subsubsection",ExpressionUUID->"4276579a-71fe-42c3-ad58-3dfe56f7f5e4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Scoeff3", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"effpot", ",", "Ss", ",", "3"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Scoeff2", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"effpot", ",", "Ss", ",", "2"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Scoeff1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"effpot", ",", "Ss", ",", "1"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Scoeff0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"effpot", ",", "Ss", ",", "0"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}]}], "Input",
 CellLabel->"In[12]:=",ExpressionUUID->"8ac77240-fe06-4968-a1da-c65c68491d26"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff3\>\"", ",", "Scoeff3"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff2\>\"", ",", "Scoeff2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff1\>\"", ",", "Scoeff1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff0\>\"", ",", "Scoeff0"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellLabel->"In[16]:=",ExpressionUUID->"a17f8b4b-762c-4159-b2b0-60d21d4e4a13"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff3 = q * \
((1 + q))**2 * u**2\"\>"], "Output",
 CellLabel->"Out[16]=",ExpressionUUID->"86257a5a-16e8-458e-a794-bdd921538602"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff2 = 1/4 \
* ((1 + q))**2 * (1 + (4 * S2**2 * u**2 + (q**2 * (1 + 4 * S1**2 * u**2) + -2 \
* q * (1 + 2 * u * ((S1**2 + S2**2) * u + (2 * kappa + -1 * \
chieff))))))\"\>"], "Output",
 CellLabel->"Out[17]=",ExpressionUUID->"3bd061ae-16d0-47fb-b977-6488295d50d5"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff1 = (q \
* (kappa + (q * kappa + -1 * chieff)) * (kappa + (q * kappa + -1 * q * \
chieff)) + (-1/2 * (-1 + q**2) * S1**2 * ((1 + q) * (-1 + (q + 4 * q * u * \
kappa)) + -2 * q * u * chieff) + -1/2 * (-1 + q**2) * S2**2 * ((1 + q) * (-1 \
+ (q + -4 * u * kappa)) + 2 * q * u * chieff)))\"\>"], "Output",
 CellLabel->"Out[18]=",ExpressionUUID->"f44b4535-88d4-4744-9334-5c46cd9a572c"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff0 = 1/4 \
* (-1 + q) * (1 + q) * ((1 + q) * ((-1 + q) * ((S1**2 + -1 * S2**2))**2 + 4 * \
(q * S1**2 + -1 * S2**2) * kappa**2) + -4 * q * (S1 + -1 * S2) * (S1 + S2) * \
kappa * chieff)\"\>"], "Output",
 CellLabel->
  "Out[19]=",ExpressionUUID->"138094be-ec4a-4874-8410-62c0b71f03c1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check reconstruction (this should be zero).", \
"Subsubsection",ExpressionUUID->"9b37a31c-25c0-4c09-9d5f-d5487b6f57e7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Scoeff3", "*", " ", 
    RowBox[{"Ss", "^", "3"}]}], "+", 
   RowBox[{"Scoeff2", "*", 
    RowBox[{"Ss", "^", "2"}]}], "+", 
   RowBox[{"Scoeff1", "*", "Ss"}], " ", "+", " ", "Scoeff0", " ", "-", " ", 
   "effpot"}], "//", "FullSimplify"}]], "Input",
 CellLabel->"In[20]:=",ExpressionUUID->"97ea8369-9b1e-4160-ab27-d845611c5cb7"],

Cell[BoxData["0"], "Output",
 CellLabel->
  "Out[20]=",ExpressionUUID->"1e74510e-19f5-4c7b-86fa-5aa0fbe61617"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["(iii) Spin-orbit resonances in \[Kappa] ", \
"Section",ExpressionUUID->"21fde227-400c-4d44-8f3c-83d485ec3535"],

Cell[CellGroupData[{

Cell["\<\
Compute discriminant of the cubic equation in S^2; multiply by some constant \
factors for consistency with previous derivations.\
\>", "Subsubsection",ExpressionUUID->"73fec41a-2ea5-4707-9e55-53addfd45485"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"discr", " ", "=", " ", 
   RowBox[{
    RowBox[{"Discriminant", "[", 
     RowBox[{"effpot", ",", "Ss"}], "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"discr", "=", " ", 
  RowBox[{"discr", 
   FractionBox["256", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["q", "2"]}], ")"}], "2"]]}]}]}], "Input",
 CellLabel->"In[21]:=",ExpressionUUID->"b8d52978-1a94-4ed4-9d8c-53de73459199"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "16"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"16", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "q"}], ")"}], "3"], " ", 
     SuperscriptBox["q", "3"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "q"}], ")"}], "6"], " ", 
     SuperscriptBox["S1", "10"], " ", 
     SuperscriptBox["u", "6"]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "q"}], ")"}], "2"], " ", 
     SuperscriptBox["q", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "q"}], ")"}], "4"], " ", 
     SuperscriptBox["S1", "8"], " ", 
     SuperscriptBox["u", "4"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"48", " ", 
        SuperscriptBox["S2", "2"], " ", 
        SuperscriptBox["u", "2"]}], "+", 
       RowBox[{"8", " ", 
        SuperscriptBox["q", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"]}], "+", 
          RowBox[{"4", " ", "u", " ", "\[Kappa]"}]}], ")"}]}], "-", 
       RowBox[{"2", " ", "q", " ", 
        RowBox[{"(", 
         RowBox[{"9", "+", 
          RowBox[{"40", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"]}], "+", 
          RowBox[{"40", " ", "u", " ", "\[Kappa]"}], "-", 
          RowBox[{"20", " ", "u", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["q", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "47"}], "+", 
          RowBox[{"16", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"]}], "+", 
          RowBox[{"16", " ", 
           SuperscriptBox["u", "2"], " ", 
           SuperscriptBox["\[Chi]eff", "2"]}], "-", 
          RowBox[{"8", " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"16", " ", "\[Kappa]"}], "+", 
             RowBox[{"3", " ", "\[Chi]eff"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["q", "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "9"}], "+", 
          RowBox[{"20", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"]}], "-", 
          RowBox[{"4", " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{"\[Kappa]", "+", 
             RowBox[{"4", " ", "\[Chi]eff"}]}], ")"}]}]}], ")"}]}]}], ")"}]}],
     "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "q"}], ")"}], " ", "q", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "q"}], ")"}], "3"], " ", 
     SuperscriptBox["S1", "6"], " ", 
     SuperscriptBox["u", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox["S2", "2"], " ", 
        SuperscriptBox["u", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "5"}], "+", 
          RowBox[{"12", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["q", "7"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"16", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "4"]}], "-", 
          RowBox[{"16", " ", "u", " ", "\[Kappa]"}], "+", 
          RowBox[{"16", " ", 
           SuperscriptBox["u", "2"], " ", 
           SuperscriptBox["\[Kappa]", "2"]}], "-", 
          RowBox[{"32", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"u", " ", "\[Kappa]"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"q", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"144", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "4"]}], "-", 
          RowBox[{"4", " ", "u", " ", "\[Kappa]"}], "+", 
          RowBox[{"2", " ", "u", " ", "\[Chi]eff"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"17", "+", 
             RowBox[{"48", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"2", " ", "u", " ", "\[Chi]eff"}]}], ")"}]}]}], ")"}]}], 
       "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["q", "2"], " ", "u", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "3"]}], "+", 
          RowBox[{"40", " ", "u", " ", 
           SuperscriptBox["\[Kappa]", "2"]}], "+", 
          RowBox[{"\[Kappa]", " ", 
           RowBox[{"(", 
            RowBox[{"13", "-", 
             RowBox[{"40", " ", "u", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
          RowBox[{"4", " ", "\[Chi]eff", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"2", " ", "u", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["S2", "2"], " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{"51", "+", 
             RowBox[{"88", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["q", "3"], " ", 
        RowBox[{"(", 
         RowBox[{"3", "-", 
          RowBox[{"272", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "4"]}], "+", 
          RowBox[{"4", " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"34", " ", "\[Kappa]"}], "-", 
             RowBox[{"19", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
          RowBox[{"32", " ", 
           SuperscriptBox["u", "3"], " ", 
           SuperscriptBox["\[Chi]eff", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "\[Kappa]"}], "+", "\[Chi]eff"}], 
            ")"}]}], "+", 
          RowBox[{"8", " ", 
           SuperscriptBox["u", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"44", " ", 
              SuperscriptBox["\[Kappa]", "2"]}], "-", 
             RowBox[{"11", " ", "\[Kappa]", " ", "\[Chi]eff"}], "-", 
             RowBox[{"14", " ", 
              SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}], "-", 
          RowBox[{"16", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"2", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"7", " ", "u", " ", "\[Chi]eff"}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["q", "5"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          RowBox[{"112", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "4"]}], "+", 
          RowBox[{"32", " ", 
           SuperscriptBox["u", "3"], " ", "\[Kappa]", " ", 
           SuperscriptBox["\[Chi]eff", "2"]}], "+", 
          RowBox[{"u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "116"}], " ", "\[Kappa]"}], "+", 
             RowBox[{"74", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["u", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "176"}], " ", 
              SuperscriptBox["\[Kappa]", "2"]}], "+", 
             RowBox[{"40", " ", "\[Kappa]", " ", "\[Chi]eff"}], "+", 
             RowBox[{"88", " ", 
              SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "21"}], "-", 
             RowBox[{"32", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"26", " ", "u", " ", "\[Chi]eff"}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["q", "4"], " ", "u", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"44", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "3"]}], "-", 
          RowBox[{"28", " ", "u", " ", 
           SuperscriptBox["\[Kappa]", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["S2", "2"], " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{"33", "+", 
             RowBox[{"80", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"24", " ", "u", " ", "\[Chi]eff"}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}], "+", 
          RowBox[{"2", " ", "\[Kappa]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "5"}], "-", 
             RowBox[{"26", " ", "u", " ", "\[Chi]eff"}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}], "+", 
          RowBox[{"2", " ", "\[Chi]eff", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"7", " ", "u", " ", "\[Chi]eff"}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["q", "6"], " ", "u", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"28", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "3"]}], "-", 
          RowBox[{"20", " ", "u", " ", 
           SuperscriptBox["\[Kappa]", "2"]}], "+", 
          RowBox[{"6", " ", "\[Chi]eff"}], "-", 
          RowBox[{"\[Kappa]", " ", 
           RowBox[{"(", 
            RowBox[{"23", "+", 
             RowBox[{"24", " ", "u", " ", "\[Chi]eff"}]}], ")"}]}], "-", 
          RowBox[{
           SuperscriptBox["S2", "2"], " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{"13", "+", 
             RowBox[{"8", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{"\[Kappa]", "+", 
                RowBox[{"3", " ", "\[Chi]eff"}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]}], ")"}]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "q"}], ")"}], " ", 
           SuperscriptBox["S2", "2"], " ", "u"}], ")"}]}], "+", "\[Kappa]", 
        "+", 
        RowBox[{"q", " ", "\[Kappa]"}], "-", 
        RowBox[{"q", " ", "\[Chi]eff"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"16", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "q"}], ")"}], "3"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}], "4"], " ", 
        SuperscriptBox["S2", "6"], " ", 
        SuperscriptBox["u", "4"]}], "+", 
       RowBox[{
        SuperscriptBox["q", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[Kappa]", "+", 
           RowBox[{"q", " ", "\[Kappa]"}], "-", "\[Chi]eff"}], ")"}], "2"], 
        " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["q", "4"], "+", 
          RowBox[{"8", " ", "q", " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "\[Kappa]"}], "+", "\[Chi]eff"}], 
            ")"}]}], "+", 
          RowBox[{"8", " ", 
           SuperscriptBox["q", "3"], " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "\[Kappa]"}], "+", "\[Chi]eff"}], 
            ")"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Chi]eff", "2"]}], "+", 
             RowBox[{"8", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "\[Kappa]"}], "+", "\[Chi]eff"}], 
               ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["q", "2"]}], ")"}], "2"], " ", 
        SuperscriptBox["S2", "4"], " ", 
        SuperscriptBox["u", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "8"}], "+", 
          SuperscriptBox["q", "4"], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "3"], " ", 
           RowBox[{"(", 
            RowBox[{"9", "+", 
             RowBox[{"24", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"4", " ", "u", " ", "\[Chi]eff"}]}], ")"}]}], "-", 
          RowBox[{"4", " ", "q", " ", 
           RowBox[{"(", 
            RowBox[{"9", "+", 
             RowBox[{"12", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"8", " ", "u", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "47"}], "+", 
             RowBox[{"16", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Chi]eff", "2"]}], "-", 
             RowBox[{"24", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", "\[Kappa]"}], "+", "\[Chi]eff"}], ")"}]}]}],
             ")"}]}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["q", "2"]}], ")"}], " ", 
        SuperscriptBox["S2", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{
           SuperscriptBox["q", "6"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"2", " ", "u", " ", "\[Kappa]"}]}], ")"}]}], "+", 
          RowBox[{"4", " ", "q", " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"5", " ", "\[Kappa]"}], "-", 
             RowBox[{"2", " ", "\[Chi]eff"}]}], ")"}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "5"], " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"24", " ", "u", " ", 
              SuperscriptBox["\[Kappa]", "2"]}], "-", 
             RowBox[{"5", " ", "\[Chi]eff"}], "+", 
             RowBox[{"\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{"8", "-", 
                RowBox[{"8", " ", "u", " ", "\[Chi]eff"}]}], ")"}]}]}], 
            ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "4"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"32", " ", 
              SuperscriptBox["u", "3"], " ", "\[Kappa]", " ", 
              SuperscriptBox["\[Chi]eff", "2"]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "40"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"18", " ", "\[Chi]eff"}]}], ")"}]}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"18", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"5", " ", "\[Kappa]", " ", "\[Chi]eff"}], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}]}], ")"}]}], 
          "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"3", "+", 
             RowBox[{"2", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"19", " ", "\[Kappa]"}], "-", 
                RowBox[{"9", " ", "\[Chi]eff"}]}], ")"}]}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"6", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"\[Kappa]", " ", "\[Chi]eff"}], "+", 
                SuperscriptBox["\[Chi]eff", "2"]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "3"], " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "72"}], " ", "u", " ", 
              SuperscriptBox["\[Kappa]", "2"]}], "+", 
             RowBox[{"2", " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"8", " ", "u", " ", "\[Chi]eff"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}], "+", 
             RowBox[{"\[Chi]eff", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"12", " ", "u", " ", "\[Chi]eff"}], "+", 
                RowBox[{"16", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "q"}], ")"}], " ", 
     SuperscriptBox["S1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"16", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "q"}], ")"}], "3"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}], "5"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", 
          RowBox[{"3", " ", "q"}]}], ")"}], " ", 
        SuperscriptBox["S2", "8"], " ", 
        SuperscriptBox["u", "6"]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "q"}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}], "4"], " ", 
        SuperscriptBox["S2", "6"], " ", 
        SuperscriptBox["u", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"5", " ", 
           SuperscriptBox["q", "4"]}], "-", 
          RowBox[{"8", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"u", " ", "\[Kappa]"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "3"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "22"}], "-", 
             RowBox[{"48", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"2", " ", "u", " ", "\[Chi]eff"}]}], ")"}]}], "-", 
          RowBox[{"q", " ", 
           RowBox[{"(", 
            RowBox[{"5", "+", 
             RowBox[{"24", " ", "u", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "24"}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Chi]eff", "2"]}], "-", 
             RowBox[{"2", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"20", " ", "\[Kappa]"}], "+", "\[Chi]eff"}], 
               ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "q"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}], "2"], " ", 
        SuperscriptBox["S2", "4"], " ", 
        SuperscriptBox["u", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["q", "8"], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"5", "+", 
             RowBox[{"8", " ", "u", " ", "\[Kappa]"}]}], ")"}]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["q", "7"], " ", 
           RowBox[{"(", 
            RowBox[{"6", "+", 
             RowBox[{"15", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"2", " ", "u", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
          RowBox[{"8", " ", "q", " ", 
           RowBox[{"(", 
            RowBox[{"3", "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["u", "2"], " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"9", " ", "\[Kappa]"}], "+", 
                RowBox[{"4", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"13", " ", "\[Kappa]"}], "+", 
                RowBox[{"8", " ", "\[Chi]eff"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "4"], " ", 
           RowBox[{"(", 
            RowBox[{"33", "+", 
             RowBox[{"32", " ", 
              SuperscriptBox["u", "3"], " ", 
              SuperscriptBox["\[Chi]eff", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "\[Kappa]"}], "+", "\[Chi]eff"}], 
               ")"}]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "40"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"28", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"18", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"17", " ", "\[Kappa]", " ", "\[Chi]eff"}], "-", 
                RowBox[{"18", " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}]}], ")"}]}], 
          "+", 
          RowBox[{
           SuperscriptBox["q", "6"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "13"}], "+", 
             RowBox[{"50", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "\[Kappa]"}], "-", "\[Chi]eff"}], ")"}]}], 
             "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"36", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"3", " ", "\[Kappa]", " ", "\[Chi]eff"}], "+", 
                SuperscriptBox["\[Chi]eff", "2"]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"8", " ", 
           SuperscriptBox["q", "5"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "9"}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "3"], " ", 
              SuperscriptBox["\[Chi]eff", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", " ", "\[Kappa]"}], "+", "\[Chi]eff"}], ")"}]}], 
             "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "46"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"3", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "72"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"6", " ", "\[Kappa]", " ", "\[Chi]eff"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}]}], ")"}]}], 
          "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["q", "3"], " ", 
           RowBox[{"(", 
            RowBox[{"18", "+", 
             RowBox[{"24", " ", 
              SuperscriptBox["u", "3"], " ", 
              SuperscriptBox["\[Chi]eff", "3"]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"103", " ", "\[Kappa]"}], "+", 
                RowBox[{"12", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"9", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"10", " ", "\[Kappa]", " ", "\[Chi]eff"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}]}], ")"}]}], 
          "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "31"}], "-", 
             RowBox[{"32", " ", 
              SuperscriptBox["u", "3"], " ", "\[Kappa]", " ", 
              SuperscriptBox["\[Chi]eff", "2"]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "76"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"22", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
             RowBox[{"16", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"9", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"\[Kappa]", " ", "\[Chi]eff"}], "+", 
                RowBox[{"4", " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "q"}], ")"}], " ", 
        SuperscriptBox["S2", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "u", " ", "\[Kappa]"}], "+", 
          RowBox[{
           SuperscriptBox["q", "10"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"2", " ", "u", " ", "\[Kappa]"}]}], ")"}]}], "-", 
          RowBox[{"2", " ", "q", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"12", " ", "\[Kappa]"}], "-", 
                RowBox[{"5", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["u", "2"], " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"15", " ", "\[Kappa]"}], "-", 
                RowBox[{"4", " ", "\[Chi]eff"}]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "9"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"12", " ", "\[Kappa]"}], "-", 
                RowBox[{"5", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["u", "2"], " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"15", " ", "\[Kappa]"}], "-", 
                RowBox[{"4", " ", "\[Chi]eff"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "-", 
             RowBox[{"6", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "3"], " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"24", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"3", " ", "\[Kappa]", " ", "\[Chi]eff"}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "4"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"4", " ", "\[Kappa]", " ", "\[Chi]eff"}], "+", 
                RowBox[{"22", " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}]}], ")"}]}], 
          "+", 
          RowBox[{
           SuperscriptBox["q", "8"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "-", 
             RowBox[{"6", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "3"], " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"24", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"3", " ", "\[Kappa]", " ", "\[Chi]eff"}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "4"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"4", " ", "\[Kappa]", " ", "\[Chi]eff"}], "+", 
                RowBox[{"22", " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}]}], ")"}]}], 
          "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["q", "5"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "36"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"15", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "4"], " ", 
              SuperscriptBox["\[Chi]eff", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"6", " ", "\[Kappa]", " ", "\[Chi]eff"}], "+", 
                RowBox[{"5", " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "86"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"20", " ", "\[Kappa]", " ", "\[Chi]eff"}], "+", 
                RowBox[{"24", " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"18", " ", 
                 SuperscriptBox["\[Kappa]", "3"]}], "+", 
                RowBox[{"6", " ", 
                 SuperscriptBox["\[Kappa]", "2"], " ", "\[Chi]eff"}], "-", 
                RowBox[{"12", " ", "\[Kappa]", " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}], "-", 
                SuperscriptBox["\[Chi]eff", "3"]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"8", " ", 
           SuperscriptBox["q", "3"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "4"], " ", "\[Kappa]", " ", 
              SuperscriptBox["\[Chi]eff", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", " ", "\[Kappa]"}], "+", 
                RowBox[{"2", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "12"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"5", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "29"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"7", " ", "\[Kappa]", " ", "\[Chi]eff"}], "+", 
                RowBox[{"6", " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "13"}], " ", 
                 SuperscriptBox["\[Kappa]", "3"]}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Kappa]", "2"], " ", "\[Chi]eff"}], "+", 
                RowBox[{"3", " ", "\[Kappa]", " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}], "+", 
                SuperscriptBox["\[Chi]eff", "3"]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"8", " ", 
           SuperscriptBox["q", "7"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "4"], " ", "\[Kappa]", " ", 
              SuperscriptBox["\[Chi]eff", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", " ", "\[Kappa]"}], "+", 
                RowBox[{"2", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "12"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"5", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "29"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"7", " ", "\[Kappa]", " ", "\[Chi]eff"}], "+", 
                RowBox[{"6", " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "13"}], " ", 
                 SuperscriptBox["\[Kappa]", "3"]}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Kappa]", "2"], " ", "\[Chi]eff"}], "+", 
                RowBox[{"3", " ", "\[Kappa]", " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}], "+", 
                SuperscriptBox["\[Chi]eff", "3"]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "4"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "-", 
             RowBox[{"2", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"16", " ", 
              SuperscriptBox["u", "4"], " ", 
              SuperscriptBox["\[Chi]eff", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Kappa]", "2"], "-", 
                RowBox[{"\[Kappa]", " ", "\[Chi]eff"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"2", " ", "\[Kappa]", " ", "\[Chi]eff"}], "+", 
                RowBox[{"11", " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"8", " ", 
                 SuperscriptBox["\[Kappa]", "3"]}], "+", 
                RowBox[{"21", " ", 
                 SuperscriptBox["\[Kappa]", "2"], " ", "\[Chi]eff"}], "-", 
                RowBox[{"10", " ", "\[Kappa]", " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["\[Chi]eff", "3"]}]}], ")"}]}]}], ")"}]}], 
          "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "6"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "-", 
             RowBox[{"2", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"16", " ", 
              SuperscriptBox["u", "4"], " ", 
              SuperscriptBox["\[Chi]eff", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Kappa]", "2"], "-", 
                RowBox[{"\[Kappa]", " ", "\[Chi]eff"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"2", " ", "\[Kappa]", " ", "\[Chi]eff"}], "+", 
                RowBox[{"11", " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"8", " ", 
                 SuperscriptBox["\[Kappa]", "3"]}], "+", 
                RowBox[{"21", " ", 
                 SuperscriptBox["\[Kappa]", "2"], " ", "\[Chi]eff"}], "-", 
                RowBox[{"10", " ", "\[Kappa]", " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["\[Chi]eff", "3"]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["q", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"\[Kappa]", "+", 
          RowBox[{"q", " ", "\[Kappa]"}], "-", "\[Chi]eff"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"16", " ", "q", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "q"}], ")"}], "4"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "5"}], "+", 
             RowBox[{"3", " ", "q"}]}], ")"}], " ", 
           SuperscriptBox["u", "2"], " ", 
           SuperscriptBox["\[Kappa]", "3"]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "q"}], ")"}], "2"], " ", "u", " ", 
           SuperscriptBox["\[Kappa]", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"5", " ", 
              SuperscriptBox["q", "5"]}], "+", 
             RowBox[{"q", " ", 
              RowBox[{"(", 
               RowBox[{"5", "-", 
                RowBox[{"20", " ", "u", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"2", " ", "u", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["q", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "5"}], "-", 
                RowBox[{"2", " ", "u", " ", "\[Chi]eff"}], "+", 
                RowBox[{"4", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["q", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"13", " ", "u", " ", "\[Chi]eff"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}]}], ")"}]}], 
          "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "q"}], ")"}], " ", "\[Kappa]", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["q", "7"], "-", 
             RowBox[{"2", " ", "u", " ", "\[Chi]eff"}], "+", 
             RowBox[{
              SuperscriptBox["q", "6"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"8", " ", "u", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "3"], " ", 
              RowBox[{"(", 
               RowBox[{"3", "-", 
                RowBox[{"52", " ", "u", " ", "\[Chi]eff"}], "-", 
                RowBox[{"88", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}], "+", 
             RowBox[{"q", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"26", " ", "u", " ", "\[Chi]eff"}], "-", 
                RowBox[{"16", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "5"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"26", " ", "u", " ", "\[Chi]eff"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}], "-", 
             RowBox[{
              SuperscriptBox["q", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"3", "-", 
                RowBox[{"12", " ", "u", " ", "\[Chi]eff"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}], "+", 
                RowBox[{"32", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Chi]eff", "3"]}]}], ")"}]}], "-", 
             RowBox[{
              SuperscriptBox["q", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"18", " ", "u", " ", "\[Chi]eff"}], "+", 
                RowBox[{"88", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}], "+", 
                RowBox[{"32", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Chi]eff", "3"]}]}], ")"}]}]}], ")"}]}], 
          "+", 
          RowBox[{"\[Chi]eff", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "q", "-", 
             SuperscriptBox["q", "7"], "-", 
             RowBox[{"10", " ", "q", " ", "u", " ", "\[Chi]eff"}], "+", 
             RowBox[{
              SuperscriptBox["q", "6"], " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"6", " ", "u", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"3", "-", 
                RowBox[{"6", " ", "u", " ", "\[Chi]eff"}], "-", 
                RowBox[{"32", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "5"], " ", 
              RowBox[{"(", 
               RowBox[{"3", "-", 
                RowBox[{"10", " ", "u", " ", "\[Chi]eff"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"20", " ", "u", " ", "\[Chi]eff"}], "+", 
                RowBox[{"24", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}], "-", 
                RowBox[{"32", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Chi]eff", "3"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"12", " ", "u", " ", "\[Chi]eff"}], "+", 
                RowBox[{"64", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}], "+", 
                RowBox[{"64", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Chi]eff", "3"]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]}], ")"}]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "q"}], ")"}], "2"], " ", 
     SuperscriptBox["S1", "4"], " ", "u", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"16", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "q"}], ")"}], "3"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}], "4"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"6", " ", "q"}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["q", "2"]}]}], ")"}], " ", 
        SuperscriptBox["S2", "6"], " ", 
        SuperscriptBox["u", "5"]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["q", "2"]}], ")"}], "2"], " ", 
        SuperscriptBox["S2", "4"], " ", 
        SuperscriptBox["u", "3"], " ", 
        RowBox[{"(", 
         RowBox[{"4", "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["q", "6"]}], "+", 
          RowBox[{"2", " ", "q", " ", 
           RowBox[{"(", 
            RowBox[{"7", "+", 
             RowBox[{"36", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"8", " ", "u", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "5"], " ", 
           RowBox[{"(", 
            RowBox[{"7", "+", 
             RowBox[{"36", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"8", " ", "u", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"77", "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Chi]eff", "2"]}], "+", 
             RowBox[{"36", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", "\[Kappa]"}], "+", "\[Chi]eff"}], ")"}]}]}],
             ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "4"], " ", 
           RowBox[{"(", 
            RowBox[{"77", "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Chi]eff", "2"]}], "+", 
             RowBox[{"36", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", "\[Kappa]"}], "+", "\[Chi]eff"}], ")"}]}]}],
             ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "3"], " ", 
           RowBox[{"(", 
            RowBox[{"134", "-", 
             RowBox[{"32", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Chi]eff", "2"]}], "+", 
             RowBox[{"8", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"18", " ", "\[Kappa]"}], "+", 
                RowBox[{"5", " ", "\[Chi]eff"}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["q", "2"]}], ")"}], " ", 
        SuperscriptBox["S2", "2"], " ", "u", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "8"], " ", 
           RowBox[{"(", 
            RowBox[{"5", "+", 
             RowBox[{"8", " ", "u", " ", "\[Kappa]"}]}], ")"}]}], "-", 
          RowBox[{"4", " ", "q", " ", 
           RowBox[{"(", 
            RowBox[{"6", "+", 
             RowBox[{"15", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"2", " ", "u", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
          RowBox[{"8", " ", 
           SuperscriptBox["q", "7"], " ", 
           RowBox[{"(", 
            RowBox[{"3", "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["u", "2"], " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"9", " ", "\[Kappa]"}], "+", 
                RowBox[{"4", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"13", " ", "\[Kappa]"}], "+", 
                RowBox[{"8", " ", "\[Chi]eff"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "4"], " ", 
           RowBox[{"(", 
            RowBox[{"33", "+", 
             RowBox[{"32", " ", 
              SuperscriptBox["u", "3"], " ", 
              SuperscriptBox["\[Chi]eff", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "\[Kappa]"}], "+", "\[Chi]eff"}], 
               ")"}]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "40"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"28", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"18", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"17", " ", "\[Kappa]", " ", "\[Chi]eff"}], "-", 
                RowBox[{"18", " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}]}], ")"}]}], 
          "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "13"}], "+", 
             RowBox[{"50", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "\[Kappa]"}], "-", "\[Chi]eff"}], ")"}]}], 
             "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"36", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"3", " ", "\[Kappa]", " ", "\[Chi]eff"}], "+", 
                SuperscriptBox["\[Chi]eff", "2"]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"8", " ", 
           SuperscriptBox["q", "3"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "9"}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "3"], " ", 
              SuperscriptBox["\[Chi]eff", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", " ", "\[Kappa]"}], "+", "\[Chi]eff"}], ")"}]}], 
             "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "46"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"3", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "72"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"6", " ", "\[Kappa]", " ", "\[Chi]eff"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}]}], ")"}]}], 
          "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["q", "5"], " ", 
           RowBox[{"(", 
            RowBox[{"18", "+", 
             RowBox[{"24", " ", 
              SuperscriptBox["u", "3"], " ", 
              SuperscriptBox["\[Chi]eff", "3"]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"103", " ", "\[Kappa]"}], "+", 
                RowBox[{"12", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"9", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"10", " ", "\[Kappa]", " ", "\[Chi]eff"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}]}], ")"}]}], 
          "+", 
          RowBox[{
           SuperscriptBox["q", "6"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "31"}], "-", 
             RowBox[{"32", " ", 
              SuperscriptBox["u", "3"], " ", "\[Kappa]", " ", 
              SuperscriptBox["\[Chi]eff", "2"]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "76"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"22", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
             RowBox[{"16", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"9", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"\[Kappa]", " ", "\[Chi]eff"}], "+", 
                RowBox[{"4", " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["q", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "16"}], " ", "q", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "q"}], ")"}], "4"], " ", 
           RowBox[{"(", 
            RowBox[{"10", "-", 
             RowBox[{"12", " ", "q"}], "+", 
             RowBox[{"3", " ", 
              SuperscriptBox["q", "2"]}]}], ")"}], " ", 
           SuperscriptBox["u", "2"], " ", 
           SuperscriptBox["\[Kappa]", "3"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "q"}], ")"}], "2"], " ", "u", " ", 
           SuperscriptBox["\[Kappa]", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["q", "6"]}], "-", 
             RowBox[{"30", " ", "q", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"4", " ", "u", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["q", "5"], " ", 
              RowBox[{"(", 
               RowBox[{"15", "+", 
                RowBox[{"8", " ", "u", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"10", "+", 
                RowBox[{"36", " ", "u", " ", "\[Chi]eff"}], "-", 
                RowBox[{"48", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}], "-", 
             RowBox[{
              SuperscriptBox["q", "4"], " ", 
              RowBox[{"(", 
               RowBox[{"11", "+", 
                RowBox[{"60", " ", "u", " ", "\[Chi]eff"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "60"}], "+", 
                RowBox[{"80", " ", "u", " ", "\[Chi]eff"}], "+", 
                RowBox[{"48", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}]}], ")"}]}], 
          "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "q"}], ")"}], " ", "\[Kappa]", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["q", "7"], "-", 
             RowBox[{"3", " ", "u", " ", "\[Chi]eff"}], "+", 
             RowBox[{
              SuperscriptBox["q", "6"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"16", " ", "u", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
             RowBox[{"q", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"49", " ", "u", " ", "\[Chi]eff"}], "-", 
                RowBox[{"48", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "5"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"49", " ", "u", " ", "\[Chi]eff"}], "+", 
                RowBox[{"40", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"22", " ", "u", " ", "\[Chi]eff"}], "+", 
                RowBox[{"80", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}], "-", 
                RowBox[{"48", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Chi]eff", "3"]}]}], ")"}]}], "-", 
             RowBox[{
              SuperscriptBox["q", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"35", " ", "u", " ", "\[Chi]eff"}], "+", 
                RowBox[{"104", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}], "+", 
                RowBox[{"48", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Chi]eff", "3"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "3"], " ", 
              RowBox[{"(", 
               RowBox[{"3", "-", 
                RowBox[{"98", " ", "u", " ", "\[Chi]eff"}], "-", 
                RowBox[{"16", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}], "+", 
                RowBox[{"80", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Chi]eff", "3"]}]}], ")"}]}]}], ")"}]}], 
          "+", 
          RowBox[{"\[Chi]eff", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["q", "7"]}], "+", 
             RowBox[{"u", " ", "\[Chi]eff"}], "+", 
             RowBox[{
              SuperscriptBox["q", "6"], " ", 
              RowBox[{"(", 
               RowBox[{"2", "-", 
                RowBox[{"23", " ", "u", " ", "\[Chi]eff"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "5"], " ", 
              RowBox[{"(", 
               RowBox[{"6", "-", 
                RowBox[{"40", " ", "u", " ", "\[Chi]eff"}], "-", 
                RowBox[{"40", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}], "+", 
             RowBox[{"q", " ", 
              RowBox[{"(", 
               RowBox[{"2", "-", 
                RowBox[{"40", " ", "u", " ", "\[Chi]eff"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "6"}], "+", 
                RowBox[{"80", " ", "u", " ", "\[Chi]eff"}], "+", 
                RowBox[{"48", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}], "-", 
                RowBox[{"96", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Chi]eff", "3"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"6", "-", 
                RowBox[{"25", " ", "u", " ", "\[Chi]eff"}], "-", 
                RowBox[{"104", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}], "+", 
                RowBox[{"16", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Chi]eff", "3"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "6"}], "+", 
                RowBox[{"47", " ", "u", " ", "\[Chi]eff"}], "+", 
                RowBox[{"120", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Chi]eff", "2"]}], "+", 
                RowBox[{"96", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Chi]eff", "3"]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellLabel->
  "Out[22]=",ExpressionUUID->"75c360b3-3251-4434-8c86-9902fdd0ea93"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Extract coefficients. Sort terms in powers of u to improve numerical \
stability.\
\>", "Subsubsection",ExpressionUUID->"945e8db9-eec2-4f56-9834-17adb2a783da"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"kappacoeff5", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Kappa]", ",", "5"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kappacoeff4", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Kappa]", ",", "4"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kappacoeff3", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Kappa]", ",", "3"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kappacoeff2", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Kappa]", ",", "2"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kappacoeff1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Kappa]", ",", "1"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kappacoeff0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Kappa]", ",", "0"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}]}], "Input",
 CellLabel->"In[23]:=",ExpressionUUID->"d937cd7c-de7f-49e6-81bf-15c7bec6bcf9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff5\>\"", ",", "kappacoeff5"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff4\>\"", ",", "kappacoeff4"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff3\>\"", ",", "kappacoeff3"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff2\>\"", ",", "kappacoeff2"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff1\>\"", ",", "kappacoeff1"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff0\>\"", ",", "kappacoeff0"}], "]"}]}], "Input",
 CellLabel->"In[29]:=",ExpressionUUID->"e6f06354-e446-48cf-a6f9-351139c005fe"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff5 = \
-256 * q**3 * ((1 + q))**6 * u\"\>"], "Output",
 CellLabel->"Out[29]=",ExpressionUUID->"764a6a4d-fc3c-4629-90b2-9d5b17cbdd1f"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff4 = 16 \
* q**2 * ((1 + q))**4 * (((-1 + q**2))**2 + (-16 * ((1 + q))**2 * (q * (-5 + \
3 * q) * S1**2 + (3 + -5 * q) * S2**2) * u**2 + (40 * q * ((1 + q))**2 * u * \
chieff + 16 * q**2 * u**2 * chieff**2)))\"\>"], "Output",
 CellLabel->"Out[30]=",ExpressionUUID->"265de85c-aada-4c8a-98e9-1733a9a3a162"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff3 = -32 \
* q * ((1 + q))**4 * (2 * q**6 * S1**2 * u * (-5 + 12 * S1**2 * u**2) + (2 * \
S2**2 * u * (-5 + 12 * S2**2 * u**2) + (2 * q**2 * u * (40 * S1**4 * u**2 + \
(-44 * S2**4 * u**2 + (8 * chieff**2 + (S1**2 * (-5 + (-8 * S2**2 * u**2 + 40 \
* u * chieff)) + -2 * S2**2 * (-5 + 4 * u * chieff * (1 + u * chieff)))))) + \
(2 * q**3 * (32 * S1**4 * u**3 + (32 * S2**4 * u**3 + (chieff * (-1 + 8 * u * \
chieff * (3 + u * chieff)) + (2 * S2**2 * u * (-1 + u * chieff * (17 + 8 * u \
* chieff)) + 2 * S1**2 * u * (-1 + (40 * S2**2 * u**2 + u * chieff * (17 + 8 \
* u * chieff))))))) + (q * (chieff + 2 * u * (S1**2 * (1 + -48 * S2**2 * \
u**2) + S2**2 * (1 + -2 * u * (12 * S2**2 * u + chieff)))) + (q**5 * (chieff \
+ 2 * u * (S2**2 + S1**2 * (1 + -2 * u * (12 * (S1**2 + 2 * S2**2) * u + \
chieff)))) + -2 * q**4 * u * (5 * S2**2 + (44 * S1**4 * u**2 + (-8 * (5 * \
S2**4 * u**2 + (5 * S2**2 * u * chieff + chieff**2)) + 2 * S1**2 * (-5 + 4 * \
u * (chieff + u * (S2**2 + chieff**2))))))))))))\"\>"], "Output",
 CellLabel->"Out[31]=",ExpressionUUID->"21099d83-b515-4abf-89dd-5e99f29635eb"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff2 = -16 \
* ((1 + q))**2 * (16 * (-1 + q) * q**3 * ((1 + q))**4 * (10 + (-8 + q) * q) * \
S1**6 * u**4 + (-16 * ((-1 + q))**3 * ((1 + q))**4 * S2**6 * u**4 + (-1 * \
((-1 + q**2))**2 * S2**4 * u**2 * (((1 + q))**2 * (-8 + (-20 + q) * q) + (8 * \
(-4 + q) * q * (1 + q) * u * chieff + 16 * q**2 * u**2 * chieff**2)) + (-1 * \
q**2 * (((1 + q) * S2**2 * u + q * chieff))**2 * ((-1 + q) * ((1 + q))**2 * \
(-1 + (q + 48 * S2**2 * u**2)) + (8 * q * (1 + q) * (5 + q) * u * chieff + 16 \
* q**2 * u**2 * chieff**2)) + (2 * q**2 * ((1 + q))**2 * S1**4 * u**2 * ((-1 \
+ q) * ((1 + q))**2 * ((-1 + q) * (-3 + (30 * q + 4 * q**2)) + -72 * (2 + (-2 \
+ q) * q) * S2**2 * u**2) + (4 * q * (1 + q) * (-30 + q * (39 + q * (-19 + 4 \
* q))) * u * chieff + -8 * q**2 * (6 + (-6 + q) * q) * u**2 * chieff**2)) + \
(-4 * q * (-1 * (1 + q) * S2**2 * u + -1 * q * chieff) * (-1 * ((-1 + q))**2 \
* ((1 + q))**3 * S2**2 * u * (-10 + (q + 24 * S2**2 * u**2)) + (-1 * (-1 + q) \
* q * ((1 + q))**2 * (-1 + (q + 4 * (1 + 2 * q) * S2**2 * u**2)) * chieff + \
(-8 * q**2 * (1 + q) * u * (2 + (q + 2 * (-1 + q) * S2**2 * u**2)) * \
chieff**2 + -16 * q**3 * u**2 * chieff**3))) + (q * (1 + q) * S1**2 * ((-1 + \
q) * ((1 + q))**3 * (((-1 + q))**3 * q + (4 * (-1 + q) * (15 + q * (-29 + 15 \
* q)) * S2**2 * u**2 + 144 * (1 + 2 * (-1 + q) * q) * S2**4 * u**4)) + (2 * q \
* ((1 + q))**2 * u * (((-1 + q))**2 * (-3 + q * (23 + 4 * q)) + 12 * (1 + q) \
* (1 + q**2) * S2**2 * u**2) * chieff + (8 * q**2 * (1 + q) * u**2 * (-12 + \
(-2 * q + (-11 * q**2 + (q**3 + 4 * (3 + q * (-5 + 3 * q)) * S2**2 * u**2)))) \
* chieff**2 + -32 * q**3 * (3 + (-1 + q) * q) * u**3 * chieff**3))) + (S2**2 \
* (((-1 + q**2))**4 + (2 * ((-1 + q))**2 * q * ((1 + q))**3 * (4 + 5 * q) * u \
* chieff + (8 * (-1 + q) * q**2 * ((1 + q))**2 * (-1 + 4 * q) * u**2 * \
chieff**2 + 32 * q**3 * (-1 + q**2) * u**3 * chieff**3))) + -1 * q**2 * \
chieff**2 * (1 + q * (8 * u * chieff + q * (-2 + (16 * u * chieff + ((q + 4 * \
u * chieff))**2))))))))))))\"\>"], "Output",
 CellLabel->"Out[32]=",ExpressionUUID->"01a8586d-affa-4ad9-b561-6d4f2ac2a6eb"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff1 = -16 \
* (1 + q) * (-16 * ((-1 + q))**2 * q**3 * ((1 + q))**5 * (-5 + 2 * q) * S1**8 \
* u**5 + (-4 * (-1 + q) * q**2 * ((1 + q))**3 * S1**6 * u**3 * ((-1 + q) * \
((1 + q))**2 * (-1 + (15 * q + (4 * q**2 + 8 * (6 + (-1 + q) * q) * S2**2 * \
u**2))) + (2 * q * (1 + q) * (20 + q * (-29 + 12 * q)) * u * chieff + -8 * \
(-2 + q) * q**2 * u**2 * chieff**2)) + (-2 * q * (((1 + q) * S2**2 * u + q * \
chieff))**2 * (-1 * ((-1 + q))**2 * ((1 + q))**3 * S2**2 * u * (-10 + (q + 24 \
* S2**2 * u**2)) + (-1 * (-1 + q) * q * ((1 + q))**2 * (-1 + (q + 4 * (1 + 2 \
* q) * S2**2 * u**2)) * chieff + (-8 * q**2 * (1 + q) * u * (2 + (q + 2 * (-1 \
+ q) * S2**2 * u**2)) * chieff**2 + -16 * q**3 * u**2 * chieff**3))) + (-2 * \
q * ((1 + q))**2 * S1**4 * u * (((-1 + q))**2 * ((1 + q))**3 * (((-1 + q))**2 \
* q + (2 * (15 + q * (-55 + 2 * q * (9 + 2 * q))) * S2**2 * u**2 + -72 * (1 + \
q**2) * S2**4 * u**4)) + ((-1 + q) * q * ((1 + q))**2 * u * (3 + (-52 * q + \
(33 * q**2 + (16 * q**3 + 4 * (-3 + 2 * q**2 * (-7 + 4 * q)) * S2**2 * \
u**2)))) * chieff + (-8 * q**2 * (1 + q) * u**2 * (6 + (-16 * q + (18 * q**2 \
+ (-5 * q**3 + 2 * (-1 + q) * (3 + (-1 + q) * q) * S2**2 * u**2)))) * \
chieff**2 + -16 * q**3 * (3 + q * (-5 + 3 * q)) * u**3 * chieff**3))) + \
(S1**2 * (-32 * ((-1 + q))**2 * ((1 + q))**5 * (1 + q * (-1 + 6 * q)) * S2**6 \
* u**5 + (-4 * (-1 + q) * ((1 + q))**3 * S2**4 * u**3 * ((-1 + q) * ((1 + \
q))**2 * (4 + q * (18 + 5 * q * (-11 + 3 * q))) + (2 * q * (1 + q) * (-8 + \
(14 * q + 3 * q**3)) * u * chieff + 8 * q**2 * (1 + q * (-1 + 3 * q)) * u**2 \
* chieff**2)) + (2 * ((1 + q))**3 * S2**2 * u * (-1 * ((-1 + q))**4 * ((1 + \
q))**2 * (1 + (-12 + q) * q) + (-2 * q * ((-1 + q**2))**2 * (4 + q * (-7 + 4 \
* q)) * u * chieff + (-8 * q**2 * (1 + q * (-8 + q * (20 + (-8 + q) * q))) * \
u**2 * chieff**2 + 16 * (-2 + q) * q**3 * (-1 + 2 * q) * u**3 * chieff**3))) \
+ 2 * q**2 * chieff * (-1 * ((-1 + q**2))**4 + (-1 * ((-1 + q))**2 * ((1 + \
q))**3 * (-1 + q * (18 + 7 * q)) * u * chieff + (4 * q * ((1 + q))**2 * (2 + \
q * (-5 + 19 * q)) * u**2 * chieff**2 + 16 * q**2 * (1 + q**2 * (2 + 3 * q)) \
* u**3 * chieff**3)))))) + -2 * (-1 * (1 + q) * S2**2 * u + -1 * q * chieff) \
* (16 * ((-1 + q))**3 * ((1 + q))**4 * S2**6 * u**4 + (((-1 + q**2))**2 * \
S2**4 * u**2 * (((1 + q))**2 * (-8 + (-20 + q) * q) + (8 * (-4 + q) * q * (1 \
+ q) * u * chieff + 16 * q**2 * u**2 * chieff**2)) + (S2**2 * (-1 * ((-1 + \
q**2))**4 + (-2 * ((-1 + q))**2 * q * ((1 + q))**3 * (4 + 5 * q) * u * chieff \
+ (-8 * (-1 + q) * q**2 * ((1 + q))**2 * (-1 + 4 * q) * u**2 * chieff**2 + \
-32 * q**3 * (-1 + q**2) * u**3 * chieff**3))) + q**2 * chieff**2 * (1 + q * \
(8 * u * chieff + q * (-2 + (16 * u * chieff + ((q + 4 * u * \
chieff))**2))))))))))))\"\>"], "Output",
 CellLabel->"Out[33]=",ExpressionUUID->"aeb2a49d-1a2d-467f-a3c7-d270162f116c"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff0 = -16 \
* (16 * ((-1 + q))**3 * q**3 * ((1 + q))**6 * S1**10 * u**6 + (-1 * ((-1 + \
q))**2 * q**2 * ((1 + q))**4 * S1**8 * u**4 * (((1 + q))**2 * (1 + (-20 * q + \
(-8 * q**2 + 16 * (-3 + (q + 2 * q**2)) * S2**2 * u**2))) + (-8 * q * (1 + q) \
* (-5 + 8 * q) * u * chieff + 16 * q**2 * u**2 * chieff**2)) + ((-1 + q) * q \
* ((1 + q))**3 * S1**6 * u**2 * (q * ((-1 + q**2))**3 + (-4 * (-1 + q) * ((1 \
+ q))**3 * (-5 + q * (27 + q * (-3 + 8 * q))) * S2**2 * u**2 + (16 * ((-1 + \
q))**2 * ((1 + q))**3 * (3 + q * (6 + q)) * S2**4 * u**4 + (-2 * (-1 + q) * q \
* ((1 + q))**2 * u * (1 + (-25 * q + (-12 * q**2 + 4 * (-1 + (q + 12 * q**2)) \
* S2**2 * u**2))) * chieff + (8 * q**2 * (1 + q) * u**2 * (4 + (-18 * q + (11 \
* q**2 + 4 * (-1 + q**2) * S2**2 * u**2))) * chieff**2 + 32 * (1 + -2 * q) * \
q**3 * u**3 * chieff**3))))) + (((1 + q))**2 * S1**4 * u * (-16 * ((-1 + \
q))**3 * ((1 + q))**4 * (1 + 3 * q * (2 + q)) * S2**6 * u**5 + (2 * S2**4 * \
u**3 * (((-1 + q))**2 * ((1 + q))**4 * (4 + q * (6 + q * (61 + (6 * q + 4 * \
q**2)))) + (4 * ((-1 + q))**2 * q * ((1 + q))**4 * (4 + (q + 4 * q**2)) * u * \
chieff + -8 * q**2 * ((-1 + q**2))**2 * (1 + q * (4 + q)) * u**2 * \
chieff**2)) + (chieff * (2 * ((-1 + q))**4 * q**2 * ((1 + q))**3 + (((q + -1 \
* q**3))**2 * (-1 + q * (40 + 23 * q)) * u * chieff + (8 * q**3 * (1 + q) * \
(-1 + q * (14 + 5 * (-4 + q) * q)) * u**2 * chieff**2 + -16 * q**4 * (1 + 6 * \
(-1 + q) * q) * u**3 * chieff**3))) + (-1 + q) * (1 + q) * S2**2 * u * (-1 * \
((-1 + q**2))**3 * (-1 + 2 * q * (12 + 5 * q)) + (-2 * (-1 + q) * q * ((1 + \
q))**2 * (-4 + q * (29 + q * (-21 + 32 * q))) * u * chieff + (-8 * q**2 * (1 \
+ q) * (1 + 2 * (-2 + q) * q * (1 + 4 * q)) * u**2 * chieff**2 + 32 * q**3 * \
(1 + q * (-1 + 3 * q)) * u**3 * chieff**3)))))) + ((1 + q) * S1**2 * (16 * \
((-1 + q))**3 * ((1 + q))**5 * (2 + 3 * q) * S2**8 * u**6 + (q**2 * chieff**2 \
* (((-1 + q))**4 * ((1 + q))**3 + (2 * q * (5 + 3 * q) * ((-1 + q**2))**2 * u \
* chieff + (-8 * q**2 * (1 + q) * (-4 + q * (7 + q)) * u**2 * chieff**2 + 32 \
* (1 + -2 * q) * q**3 * u**3 * chieff**3))) + ((-1 + q) * ((1 + q))**2 * \
S2**4 * u**2 * ((-10 + (-24 + q) * q) * ((-1 + q**2))**3 + (2 * (-1 + q) * q \
* ((1 + q))**2 * (-32 + q * (21 + q * (-29 + 4 * q))) * u * chieff + (8 * \
q**2 * (1 + q) * (8 + q * (-14 + (-4 + q) * q)) * u**2 * chieff**2 + -32 * \
q**3 * (3 + (-1 + q) * q) * u**3 * chieff**3))) + (S2**2 * (-1 * ((-1 + \
q))**6 * ((1 + q))**5 + (-10 * ((-1 + q))**4 * q * ((1 + q))**5 * u * chieff \
+ (-2 * ((-1 + q))**2 * q**2 * ((1 + q))**3 * (11 + q * (-24 + 11 * q)) * \
u**2 * chieff**2 + (16 * q**3 * ((1 + q))**3 * (2 + q * (-3 + 2 * q)) * u**3 \
* chieff**3 + 32 * q**4 * (1 + q) * (3 + q * (-5 + 3 * q)) * u**4 * \
chieff**4)))) + 4 * ((-1 + q))**2 * ((1 + q))**4 * S2**6 * u**4 * (-8 + q * \
(-5 + (-24 * q + (-22 * q**2 + (5 * q**3 + (2 * (-4 + q) * (3 + q) * u * \
chieff + 8 * q * u**2 * chieff**2)))))))))) + -1 * (((1 + q) * S2**2 * u + q \
* chieff))**2 * (16 * ((-1 + q))**3 * ((1 + q))**4 * S2**6 * u**4 + (((-1 + \
q**2))**2 * S2**4 * u**2 * (((1 + q))**2 * (-8 + (-20 + q) * q) + (8 * (-4 + \
q) * q * (1 + q) * u * chieff + 16 * q**2 * u**2 * chieff**2)) + (S2**2 * (-1 \
* ((-1 + q**2))**4 + (-2 * ((-1 + q))**2 * q * ((1 + q))**3 * (4 + 5 * q) * u \
* chieff + (-8 * (-1 + q) * q**2 * ((1 + q))**2 * (-1 + 4 * q) * u**2 * \
chieff**2 + -32 * q**3 * (-1 + q**2) * u**3 * chieff**3))) + q**2 * chieff**2 \
* (1 + q * (8 * u * chieff + q * (-2 + (16 * u * chieff + ((q + 4 * u * \
chieff))**2))))))))))))\"\>"], "Output",
 CellLabel->
  "Out[34]=",ExpressionUUID->"116b8b8a-f0ca-456b-b1dc-e0ed254c9495"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check reconstruction (this should be zero).", \
"Subsubsection",ExpressionUUID->"ba0a2d07-9cac-4ed3-8741-54361a95c2b7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"kappacoeff5", "*", " ", 
    RowBox[{"\[Kappa]", "^", "5"}]}], "+", 
   RowBox[{"kappacoeff4", "*", " ", 
    RowBox[{"\[Kappa]", "^", "4"}]}], "+", 
   RowBox[{"kappacoeff3", "*", " ", 
    RowBox[{"\[Kappa]", "^", "3"}]}], "+", 
   RowBox[{"kappacoeff2", "*", " ", 
    RowBox[{"\[Kappa]", "^", "2"}]}], "+", 
   RowBox[{"kappacoeff1", "*", " ", "\[Kappa]"}], "+", "kappacoeff0", "-", 
   "discr"}], "//", "FullSimplify"}]], "Input",
 CellLabel->"In[35]:=",ExpressionUUID->"15f321bd-5fda-4b2a-ab8b-565753dd3d19"],

Cell[BoxData["0"], "Output",
 CellLabel->
  "Out[35]=",ExpressionUUID->"59d7fcee-d2c1-41a0-a140-f27d7163d414"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["(iv) Spin-orbit resonances in xi ", \
"Section",ExpressionUUID->"239d809c-3fa6-4a88-9042-038f22fe16f3"],

Cell[CellGroupData[{

Cell["\<\
Extract coefficients. Sort terms in powers of u to improve numerical \
stability.\
\>", "Subsubsection",ExpressionUUID->"58c0bcac-b836-48dd-989a-10f05becb9c7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"chieffcoeff6", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Chi]eff", ",", "6"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chieffcoeff5", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Chi]eff", ",", "5"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chieffcoeff4", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Chi]eff", ",", "4"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chieffcoeff3", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Chi]eff", ",", "3"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chieffcoeff2", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Chi]eff", ",", "2"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chieffcoeff1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Chi]eff", ",", "1"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chieffcoeff0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Chi]eff", ",", "0"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}]}], "Input",
 CellLabel->"In[36]:=",ExpressionUUID->"80cb3e5c-2215-4edc-81f6-cea6571d6124"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff6\>\"", ",", "chieffcoeff6"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff5\>\"", ",", "chieffcoeff5"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff4\>\"", ",", "chieffcoeff4"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff3\>\"", ",", "chieffcoeff3"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff2\>\"", ",", "chieffcoeff2"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff1\>\"", ",", "chieffcoeff1"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff0\>\"", ",", "chieffcoeff0"}], "]"}]}], "Input",
 CellLabel->"In[43]:=",ExpressionUUID->"7c8b37e2-c2e7-4d99-af37-652b106ca9cc"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff6 = 256 \
* q**6 * u**2\"\>"], "Output",
 CellLabel->"Out[43]=",ExpressionUUID->"71122e2c-ce02-44e3-854b-18d9d2bb39ec"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff5 = 128 \
* q**5 * (1 + q) * u * (1 + (q + (8 * q * S1**2 * u**2 + (-4 * u * (S1**2 * u \
+ (-2 * S2**2 * u + kappa)) + -4 * q * u * (S2**2 * u + kappa)))))\"\>"], \
"Output",
 CellLabel->"Out[44]=",ExpressionUUID->"d99c1c5a-6fb1-460e-82b8-f0f970ab31e8"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff4 = 16 \
* q**4 * ((1 + q))**2 * (1 + (-32 * S1**2 * u**2 + (8 * u * (12 * S2**4 * \
u**3 + (-2 * kappa + (2 * u * ((-1 * S1**2 * u + kappa))**2 + S2**2 * u * (1 \
+ -12 * u * (S1**2 * u + kappa))))) + (q * (-2 + (-96 * S1**4 * u**4 + (8 * \
S1**2 * u**2 * (7 + 4 * u * (5 * S2**2 * u + kappa)) + 8 * u * (-12 * S2**4 * \
u**3 + (2 * kappa * (-3 + 4 * u * kappa) + S2**2 * u * (7 + 4 * u * \
kappa)))))) + q**2 * (1 + 8 * u * (-2 * kappa + u * (-4 * S2**2 + (12 * S1**4 \
* u**2 + (2 * ((-1 * S2**2 * u + kappa))**2 + S1**2 * (1 + -12 * u * (S2**2 * \
u + kappa)))))))))))\"\>"], "Output",
 CellLabel->"Out[45]=",ExpressionUUID->"216b731b-5f97-46ca-8738-df264f865677"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff3 = 32 \
* q**3 * ((1 + q))**3 * (16 * (-1 + q) * q * (-1 + 2 * q) * S1**6 * u**5 + \
(16 * (-2 + q) * (-1 + q) * S2**6 * u**5 + (4 * S2**4 * u**3 * (-5 + (20 * q \
+ (-14 * q**2 + (q**3 + -4 * (3 + q * (-5 + 3 * q)) * u * kappa)))) + ((1 + \
q) * kappa * (-1 * ((-1 + q))**2 + (4 * (1 + q * (8 + q)) * u * kappa + -16 * \
q * u**2 * kappa**2)) + (S2**2 * u * (-1 * ((-1 + q))**2 * (3 + 5 * q) + (-4 \
* q * (19 + q * (-5 + 2 * q)) * u * kappa + 16 * (1 + q * (-1 + 3 * q)) * \
u**2 * kappa**2)) + (-4 * S1**4 * u**3 * (-1 + (-4 * S2**2 * u**2 + q * (14 + \
(5 * (-4 + q) * q + (8 * S2**2 * u**2 + (4 * q * (-4 + 3 * q) * S2**2 * u**2 \
+ 4 * (3 + q * (-5 + 3 * q)) * u * kappa)))))) + S1**2 * u * (-5 + (-8 * u * \
(6 * S2**4 * u**3 + (kappa + 2 * S2**2 * u * (1 + 2 * u * kappa))) + (q * (7 \
+ (64 * S2**4 * u**4 + (8 * S2**2 * u**2 * (1 + 6 * u * kappa) + 4 * u * \
kappa * (5 + 12 * u * kappa)))) + (q**3 * (-3 + 16 * u**2 * (S2**4 * u**2 + \
(kappa**2 + -1 * S2**2 * (1 + 2 * u * kappa)))) + q**2 * (1 + -4 * u * (8 * \
S2**4 * u**3 + (kappa * (19 + 4 * u * kappa) + -2 * S2**2 * u * (1 + 6 * u * \
kappa))))))))))))))\"\>"], "Output",
 CellLabel->"Out[46]=",ExpressionUUID->"10da347d-5748-4ffd-babe-7a00f606153b"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff2 = 16 \
* q**2 * ((1 + q))**4 * (16 * ((-1 + q))**2 * q**2 * S1**8 * u**6 + (16 * \
((-1 + q))**2 * S2**8 * u**6 + (kappa**2 * (((-1 + q))**2 * (1 + q * (4 + q)) \
+ (-32 * q * (1 + q * (3 + q)) * u * kappa + 16 * q**2 * u**2 * kappa**2)) + \
(S2**4 * u**2 * (((-1 + q))**2 * (-23 + (-40 + q) * q) + (16 * (5 + -2 * q * \
(9 + q * (-8 + 3 * q))) * u * kappa + 16 * (1 + 6 * (-1 + q) * q) * u**2 * \
kappa**2)) + (S2**2 * (-1 * ((-1 + q))**4 + (-2 * ((-1 + q))**2 * (-7 + (-18 \
+ q) * q) * u * kappa + (8 * (-1 + q * (11 + 2 * q * (1 + 6 * q))) * u**2 * \
kappa**2 + 32 * (1 + -2 * q) * q * u**3 * kappa**3))) + (8 * (-1 + q) * S2**6 \
* u**4 * (11 + (4 * u * kappa + 2 * q * (-9 + (2 * q + -4 * u * kappa)))) + \
(-8 * (-1 + q) * q * S1**6 * u**4 * (4 + (-4 * S2**2 * u**2 + q * (-18 + (-8 \
* u * kappa + q * (11 + 4 * u * (S2**2 * u + kappa)))))) + (S1**4 * u**2 * \
(((1 + -4 * S2**2 * u**2))**2 + (q**4 * (-23 + 16 * u * (S2**4 * u**3 + (-2 * \
S2**2 * u * (-2 + u * kappa) + kappa * (5 + u * kappa)))) + (2 * q**3 * (3 + \
8 * u * (2 * S2**4 * u**3 + (-6 * kappa * (3 + u * kappa) + S2**2 * u * (-11 \
+ 4 * u * kappa)))) + (q**2 * (58 + -16 * u * (6 * S2**4 * u**3 + (-2 * kappa \
* (8 + 3 * u * kappa) + S2**2 * u * (-5 + 8 * u * kappa)))) + q * (-42 + 8 * \
u * (-12 * kappa + S2**2 * u * (5 + 4 * u * (S2**2 * u + 3 * kappa)))))))) + \
S1**2 * (-1 + (4 * q**3 * (1 + (-8 * S2**6 * u**6 + (2 * S2**4 * u**4 * (5 + \
12 * u * kappa) + (-1 * S2**2 * u**2 * (23 + 8 * u * kappa * (4 + 3 * u * \
kappa)) + 2 * u * kappa * (1 + u * kappa * (11 + 4 * u * kappa)))))) + (q**4 \
* (-1 + 2 * u * (-4 * S2**4 * u**3 + (kappa * (7 + -4 * u * kappa) + S2**2 * \
u * (11 + 8 * u * kappa)))) + (2 * q**2 * (-3 + 2 * u * (8 * S2**6 * u**5 + \
(4 * S2**4 * u**3 * (5 + -8 * u * kappa) + (kappa * (-15 + 4 * u * kappa * (1 \
+ -4 * u * kappa)) + 5 * S2**2 * u * (7 + 8 * u * kappa * (2 + u * \
kappa)))))) + (4 * q * (1 + u * (8 * S2**6 * u**5 + (4 * S2**4 * u**3 * (-11 \
+ 4 * u * kappa) + (2 * kappa * (5 + 12 * u * kappa) + -1 * S2**2 * u * (23 + \
8 * u * kappa * (4 + 3 * u * kappa)))))) + 2 * u * (-1 * kappa + S2**2 * u * \
(11 + 8 * u * (kappa + -2 * S2**2 * u * (-2 + u * (S2**2 * u + \
kappa))))))))))))))))))\"\>"], "Output",
 CellLabel->"Out[47]=",ExpressionUUID->"826540d3-79ab-4e53-a498-eecab0c8a8d2"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff1 = -32 \
* q * ((1 + q))**2 * (4 * ((-1 + q))**2 * q**2 * ((1 + q))**3 * (-5 + 8 * q) \
* S1**8 * u**5 + (-1 * (-1 + q) * q * ((1 + q))**3 * S1**6 * u**3 * (-1 + (26 \
* q + (-13 * q**2 + (-12 * q**3 + (4 * (-1 + q) * (1 + 3 * q) * (-1 + 4 * q) \
* S2**2 * u**2 + 4 * q * (20 + q * (-29 + 12 * q)) * u * kappa))))) + ((-1 * \
(1 + q) * S2**2 * u + (kappa + q * kappa)) * (16 * ((-1 + q))**3 * ((1 + \
q))**2 * S2**6 * u**4 + (q**2 * ((1 + q))**2 * kappa**2 * (((-1 + q))**2 + \
-16 * q * u * kappa) + (-1 * (-1 + q) * ((1 + q))**2 * S2**2 * (((-1 + q))**3 \
+ (2 * (-10 + q) * (-1 + q) * q * u * kappa + -48 * q**2 * u**2 * kappa**2)) \
+ ((-1 + q**2))**2 * S2**4 * u**2 * (-8 + q * (-20 + (q + -48 * u * \
kappa)))))) + (-1 * (1 + q) * ((-1 * (1 + q) * S2**2 * u + (kappa + q * \
kappa)))**2 * (4 * (-4 + q) * ((-1 + q))**2 * S2**4 * u**3 + (q * kappa * (-1 \
* ((-1 + q))**2 + 4 * q * (5 + q) * u * kappa) + -1 * (-1 + q) * S2**2 * u * \
(-4 + q * (-1 + (4 * u * kappa + q * (5 + 8 * u * kappa)))))) + (((1 + q))**3 \
* S1**2 * (4 * (-4 + q) * ((-1 + q))**2 * (3 + q) * S2**6 * u**5 + ((1 + q) * \
S2**2 * u * (-5 * ((-1 + q))**4 + (-2 * ((-1 + q))**2 * (4 + q * (-7 + 4 * \
q)) * u * kappa + 12 * q * (1 + q**2) * u**2 * kappa**2)) + (q * kappa * (-1 \
* ((-1 + q))**4 + (((-1 + q))**2 * (-3 + q * (23 + 4 * q)) * u * kappa + -4 * \
q * (-20 + q * (3 + q)) * u**2 * kappa**2)) + (-1 + q) * S2**4 * u**3 * (32 * \
(1 + u * kappa) + q * (-53 + (-56 * u * kappa + q * (50 + q * (-33 + (4 * q + \
-12 * u * kappa))))))))) + -1 * ((1 + q))**2 * S1**4 * u * (-4 * ((-1 + \
q**2))**2 * (4 + (q + 4 * q**2)) * S2**4 * u**4 + (q * (1 + q) * (-1 * ((-1 + \
q))**4 + (((-1 + q))**2 * (-3 + q * (49 + 16 * q)) * u * kappa + 4 * q * (30 \
+ q * (-39 + (19 + -4 * q) * q)) * u**2 * kappa**2)) + (-1 + q**2) * S2**2 * \
u**2 * (4 + q * (-3 * (11 + 4 * u * kappa) + q * (50 + q * (-53 + (32 * q + 8 \
* (-7 + 4 * q) * u * kappa))))))))))))\"\>"], "Output",
 CellLabel->"Out[48]=",ExpressionUUID->"48fa6989-7ac9-41f0-aeb0-698f8ebd6a80"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff0 = -16 \
* ((1 + q))**4 * (16 * ((-1 + q))**3 * q**3 * ((1 + q))**2 * S1**10 * u**6 + \
((-1 + q) * q * ((1 + q))**2 * S1**6 * u**2 * ((-1 + q) * (((-1 + q))**2 * q \
+ (-4 * (-5 + q * (27 + q * (-3 + 8 * q))) * S2**2 * u**2 + 16 * (-1 + q) * \
(3 + q * (6 + q)) * S2**4 * u**4)) + (-4 * (-1 + q) * q * u * (-1 + (15 * q + \
(4 * q**2 + 8 * (6 + (-1 + q) * q) * S2**2 * u**2))) * kappa + 16 * q**2 * \
(10 + (-8 + q) * q) * u**2 * kappa**2)) + (-1 * S1**4 * u * (16 * ((-1 + \
q))**3 * ((1 + q))**2 * (1 + 3 * q * (2 + q)) * S2**6 * u**5 + (-2 * ((-1 + \
q**2))**2 * S2**4 * u**3 * (4 + (q * (6 + q * (61 + (6 * q + 4 * q**2))) + 72 \
* (q + q**3) * u * kappa)) + (2 * kappa * (((-1 + q))**4 * q**2 * ((1 + \
q))**2 + (-1 * (-3 + (30 * q + 4 * q**2)) * ((q + -1 * q**3))**2 * u * kappa \
+ -8 * q**3 * ((1 + q))**2 * (10 + 3 * (-4 + q) * q) * u**2 * kappa**2)) + \
(-1 + q) * ((1 + q))**2 * S2**2 * u * (((-1 + q))**3 * (-1 + 2 * q * (12 + 5 \
* q)) + (4 * (-1 + q) * q * (15 + q * (-55 + 2 * q * (9 + 2 * q))) * u * \
kappa + 144 * q**2 * (2 + (-2 + q) * q) * u**2 * kappa**2))))) + (((1 + \
q))**2 * S1**2 * (16 * ((-1 + q))**3 * (2 + 3 * q) * S2**8 * u**6 + (4 * ((-1 \
+ q))**2 * S2**6 * u**4 * (-8 + (3 * q + (-27 * q**2 + (5 * q**3 + 8 * (-1 + \
(q + -6 * q**2)) * u * kappa)))) + (q**2 * kappa**2 * (((-1 + q))**4 + (-4 * \
((-1 + q))**2 * (-1 + 5 * q) * u * kappa + 16 * q * (-5 + 3 * q) * u**2 * \
kappa**2)) + ((-1 + q) * S2**4 * u**2 * (((-1 + q))**3 * (-10 + (-24 + q) * \
q) + (-4 * (-1 + q) * (4 + q * (18 + 5 * q * (-11 + 3 * q))) * u * kappa + \
144 * q * (1 + 2 * (-1 + q) * q) * u**2 * kappa**2)) + S2**2 * (-1 * ((-1 + \
q))**6 + (-2 * ((-1 + q))**4 * (1 + (-12 + q) * q) * u * kappa + (4 * ((-1 + \
q))**2 * q * (15 + q * (-29 + 15 * q)) * u**2 * kappa**2 + -32 * q**2 * (6 + \
q * (-11 + 6 * q)) * u**3 * kappa**3))))))) + (-1 * ((-1 * S2**2 * u + \
kappa))**2 * (16 * ((-1 + q))**3 * ((1 + q))**2 * S2**6 * u**4 + (q**2 * ((1 \
+ q))**2 * kappa**2 * (((-1 + q))**2 + -16 * q * u * kappa) + (-1 * (-1 + q) \
* ((1 + q))**2 * S2**2 * (((-1 + q))**3 + (2 * (-10 + q) * (-1 + q) * q * u * \
kappa + -48 * q**2 * u**2 * kappa**2)) + ((-1 + q**2))**2 * S2**4 * u**2 * \
(-8 + q * (-20 + (q + -48 * u * kappa)))))) + -1 * ((q + -1 * q**3))**2 * \
S1**8 * u**4 * (1 + (-48 * S2**2 * u**2 + 4 * q * (-5 + (4 * u * (S2**2 * u + \
-5 * kappa) + q * (-2 + 8 * u * (S2**2 * u + kappa)))))))))))\"\>"], "Output",
 
 CellLabel->
  "Out[49]=",ExpressionUUID->"445582fd-ffaf-4121-baf6-d6eb8ce3957d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check reconstruction (this should be zero).", \
"Subsubsection",ExpressionUUID->"730e5d62-f9f9-4bdb-909d-ab3b019a6fcb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"chieffcoeff6", "*", " ", 
    RowBox[{"\[Chi]eff", "^", "6"}]}], "+", 
   RowBox[{"chieffcoeff5", "*", " ", 
    RowBox[{"\[Chi]eff", "^", "5"}]}], "+", " ", 
   RowBox[{"chieffcoeff4", "*", " ", 
    RowBox[{"\[Chi]eff", "^", "4"}]}], "+", 
   RowBox[{"chieffcoeff3", "*", " ", 
    RowBox[{"\[Chi]eff", "^", "3"}]}], " ", "+", " ", 
   RowBox[{"chieffcoeff2", "*", " ", 
    RowBox[{"\[Chi]eff", "^", "2"}]}], " ", "+", " ", 
   RowBox[{"chieffcoeff1", "*", " ", "\[Chi]eff"}], "+", " ", "chieffcoeff0", 
   " ", "-", "discr"}], "//", "FullSimplify"}]], "Input",
 CellLabel->"In[50]:=",ExpressionUUID->"4c8bead5-8bb5-498b-b9b7-01a806f7554c"],

Cell[BoxData["0"], "Output",
 CellLabel->
  "Out[50]=",ExpressionUUID->"30c21050-3f49-43d6-b246-5edfac25bd79"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Clean this notebook for inclusion in git repository. ",
 StyleBox["Credits: http://bhptoolkit.org/cleannb.html", "Subsection"],
 " "
}], "Subsubsection",ExpressionUUID->"0f9a2f89-064e-4c66-b44c-a5312e6cc816"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CleanNotebook", "[", "file_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nb", ",", "contents", ",", "newcontents"}], "}"}], ",", 
     RowBox[{
      RowBox[{"nb", "=", 
       RowBox[{"NotebookOpen", "[", "file", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SetOptions", "[", 
       RowBox[{"nb", ",", 
        RowBox[{"\"\<TrackCellChangeTimes\>\"", "->", "False"}], ",", 
        RowBox[{"PrivateNotebookOptions", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<FileOutlineCache\>\"", "->", "False"}], "}"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"contents", "=", 
       RowBox[{"NotebookGet", "[", "nb", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"newcontents", "=", 
       RowBox[{"contents", "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CellChangeTimes", "->", "_"}], ")"}], "->", 
           RowBox[{"Sequence", "[", "]"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CellTags", "->", "_"}], ")"}], "->", 
           RowBox[{"Sequence", "[", "]"}]}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"NotebookPut", "[", 
       RowBox[{"newcontents", ",", "nb"}], "]"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"NotebookSave", "[", "nb", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"NotebookClose", "[", "nb", "]"}], ";"}]}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[51]:=",ExpressionUUID->"a65d8011-2328-474d-b18f-1dc628a3de02"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CleanNotebook", "[", 
   RowBox[{"NotebookFileName", "[", "]"}], "]"}], ";"}]], "Input",
 CellLabel->
  "In[52]:=",ExpressionUUID->"f1fa2388-b407-4764-aaca-9fa38fe73b16"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1654, 847},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"FileOutlineCache"->False},
FrontEndVersion->"13.0 for Mac OS X x86 (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
$CellContext`TrackCellChangeTimes -> False,
ExpressionUUID->"ceb27b6a-17ef-40ed-91d0-092d78b52fe3"
]

